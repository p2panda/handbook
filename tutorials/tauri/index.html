<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/tauri" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Tutorial: Embed a node in Tauri | p2panda</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://p2panda.org/tutorials/tauri"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tutorial: Embed a node in Tauri | p2panda"><meta data-rh="true" name="description" content="In this tutorial we will see how to embed an aquadoggo node in a Tauri app. Tauri is a framework for building apps which have a Rust backend and WebView frontend which will compile for all major desktop platforms (mobile coming soon). This means we can easily package our aquadoggo node alongside a frontend written in your favorite web framework (or none at all!)."><meta data-rh="true" property="og:description" content="In this tutorial we will see how to embed an aquadoggo node in a Tauri app. Tauri is a framework for building apps which have a Rust backend and WebView frontend which will compile for all major desktop platforms (mobile coming soon). This means we can easily package our aquadoggo node alongside a frontend written in your favorite web framework (or none at all!)."><link data-rh="true" rel="icon" href="/images/deepsea-panda.svg"><link data-rh="true" rel="canonical" href="https://p2panda.org/tutorials/tauri"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/tauri" hreflang="en"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/tauri" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="p2panda News RSS Feed"><link rel="stylesheet" href="/assets/css/styles.862b1275.css">
<script src="/assets/js/runtime~main.2350abd3.js" defer="defer"></script>
<script src="/assets/js/main.cec126d6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="navbar__brand"><div class="navbar__logo"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></div></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/sdks/">SDKs</a><a class="navbar__item navbar__link" href="/specifications/">Specifications</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/links">Links</a><a class="navbar__item navbar__link" href="/contact">Contact</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tutorial: Embed a node in Tauri</h1></header><p>In this tutorial we will see how to embed an <code>aquadoggo</code> node in a Tauri app. Tauri is a framework for building apps which have a Rust backend and WebView frontend which will compile for all major desktop platforms (mobile coming soon). This means we can easily package our <code>aquadoggo</code> node alongside a frontend written in your favorite web framework (or none at all!).</p>
<p>In this tutorial we will focus on the backend code, where we&#x27;ll embed our node, implement secure persistent storage for both WebView (LocalStorage) and node data, demonstrate useful node configuration flows, populate the node with app schemas on startup and define commands callable from the frontend.</p>
<p>We&#x27;ll look at the frontend code which demonstrates advanced GraphQL queries and how to publish and retrieve blobs in the following tutorials.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-do-i-need">What do I need?<a href="#what-do-i-need" class="hash-link" aria-label="Direct link to What do I need?" title="Direct link to What do I need?">‚Äã</a></h2>
<ul>
<li>NodeJS</li>
<li>Rust</li>
<li>Tauri dependencies</li>
<li>Editor</li>
<li>Terminal</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Never worked with Rust and/or Tauri before?</div><div class="admonitionContent_BuS1"><p>This tutorial requires you to have a working Rust environment and all Tauri dependencies installed. If you have never worked with Rust and/or Tauri before this is no problem! Setting it up is fairly easy and besides using some basic command line commands there is no more Rust knowledge required to make the node run on your computer.</p></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>How do I install NodeJS?</summary><div><div class="collapsibleContent_i85q"><div><p>You can check out the official <a href="https://nodejs.org/en/download/package-manager/" target="_blank" rel="noopener noreferrer">Installing Node.js via package manager</a> guidelines here. But we would recommend you installing a NodeJS version manager like <a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener noreferrer">nvm</a>, or even better <a href="https://github.com/tj/n" target="_blank" rel="noopener noreferrer">n</a>. We used the NodeJS version <code>18.17.0</code> for this tutorial.</p></div></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>How do I install Rust &amp; Tauri dependencies?</summary><div><div class="collapsibleContent_i85q"><div><p>Make sure you have a working Rust environment and all Tauri dependencies installed on your computer before you begin with the tutorial. You can check Rust is installed by running <code>rustc --version</code> in your terminal. This tutorial was written with Rust version <code>1.75.0</code> but it will probably also work with other versions.</p><p>If you don&#x27;t have Rust installed yet or you need just the Tauri dependencies you can follow the steps from the Tauri website: <a href="https://tauri.app/v1/guides/getting-started/prerequisites" target="_blank" rel="noopener noreferrer">Tauri: Getting Started</a>.</p></div></div></div></details>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>What is <code>aquadoggo</code>?</div><div class="admonitionContent_BuS1"><p>If you aren&#x27;t familiar with <code>aquadoggo</code> then I recommend checking out the <a href="/tutorials/aquadoggo">&quot;Set up a local node&quot;</a> tutorial before you do this one. It focuses on using <code>aquadoggo</code> on the command line, but all the features and configuration parameters are the same when working with it programmatically.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="download-the-application-code">Download the application code<a href="#download-the-application-code" class="hash-link" aria-label="Direct link to Download the application code" title="Direct link to Download the application code">‚Äã</a></h2>
<p>Everything we need for this tutorial is in the <code>p2panda/tauri-example</code> repository. Download the code and install NodeJS dependencies like so.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Clone the `tauri-example` git repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">git</span><span class="token plain"> clone https://github.com/p2panda/tauri-example</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Move into the folder you&#x27;ve just created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token builtin class-name" style="color:#9ddab3">cd</span><span class="token plain"> tauri-example</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Install NodeJS dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="run-the-application">Run the application<a href="#run-the-application" class="hash-link" aria-label="Direct link to Run the application" title="Direct link to Run the application">‚Äã</a></h2>
<p>First we&#x27;re going to simply run the application, this will compile the front and backend and launch the app in dev mode. The first step (compilation) will likely take... a while.... don&#x27;t worry though, this is only the case the first time you run the command, after that only incremental compilation is required and things will be a lot quicker.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Run the tauri app in dev mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run tauri dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>What&#x27;s &quot;dev&quot; mode?</div><div class="admonitionContent_BuS1"><p>When we launch an app in &quot;dev&quot; mode it means we are still in development, and so rather than an optimized build with production settings, we want to work in a developer friendly environment. In this case that means we don&#x27;t persist any app data to the filesystem and want code hot-reloading to be activated (the app updates automatically when we edit the code).</p></div></div>
<p>You should see some output in your terminal like this (missing out the long compilation process):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run tauri dev</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> p2panda-tauri-example@0.0.0 tauri</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> tauri dev</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">     Running BeforeDevCommand </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token variable" style="color:#f2f0ec">`</span><span class="token variable function" style="color:#66cccc;font-weight:bold">npm</span><span class="token variable" style="color:#f2f0ec"> run dev</span><span class="token variable" style="color:#f2f0ec">`</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> p2panda-tauri-example@0.0.0 dev</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> vite</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  VITE v4.5.2  ready </span><span class="token keyword" style="color:#ffcc66">in</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">135</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ‚ûú  Local:   http://localhost:1420/</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  ‚ûú  Network: use </span><span class="token parameter variable" style="color:#f2f0ec">--host</span><span class="token plain"> to expose</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        Info Watching /home/sandreae/Code/tauri-example-test/src-tauri </span><span class="token keyword" style="color:#ffcc66">for</span><span class="token plain"> changes</span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    Finished dev </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token plain">unoptimized + debuginfo</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> target</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">in</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">0</span><span class="token plain">.19s</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Go to http://0.0.0.0:2020/graphql to use GraphQL playground</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Peer id: 12D3KooWPzHvt52CYkYPvejsBjgjcsqyBszcEQrDhDp6RSdYx6qx</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Node is listening on </span><span class="token number" style="color:#cc99cc">0.0</span><span class="token plain">.0.0:2022</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Schema migration: app schemas successfully deployed on initial start-up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We&#x27;re using <code>vite</code> to package the frontend code and assets, you can see that a dev server is started at <code>http://localhost:1420/</code>. This is where tauri will look for the frontend app during development. Next the Rust code is compiled and eventually the app is launched. The last four lines are logging from the <code>aquadoggo</code> node which has now started up. You can go to <code>localhost:2020/graphql</code> to check the GraphQL playground is being served correctly.</p>
<p>The app window should now have opened, it&#x27;ll be a blank screen.... not very interesting... until you start clicking! Then you can draw pointless messages like this with panda gif stickers (yay!):</p>
<p><img loading="lazy" src="/assets/images/tauri-example-screenshot-b2b1ba7341e37b7cfd2a782efdfedbdb.png" width="828" height="666" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-does-it-all-work">How does it all work?<a href="#how-does-it-all-work" class="hash-link" aria-label="Direct link to How does it all work?" title="Direct link to How does it all work?">‚Äã</a></h2>
<p>A <em>lot</em> happened there, but it&#x27;s worth pointing out now that you don&#x27;t actually need to know much about it if you just want to start hacking on a web client (for that you can go straight to <code>src/</code> where all the frontend JavaScript code is). This tutorial would be quite short if we didn&#x27;t dig a bit deeper though. Let&#x27;s take it step by step.</p>
<p>As we saw from the logging, a node <em>did</em> start up, so where did it come from?</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="embedding-an-aquadoggo-node">Embedding an <code>aquadoggo</code> node<a href="#embedding-an-aquadoggo-node" class="hash-link" aria-label="Direct link to embedding-an-aquadoggo-node" title="Direct link to embedding-an-aquadoggo-node">‚Äã</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="add-aquadoggo-to-cargotoml">Add <code>aquadoggo</code> to <code>Cargo.toml</code><a href="#add-aquadoggo-to-cargotoml" class="hash-link" aria-label="Direct link to add-aquadoggo-to-cargotoml" title="Direct link to add-aquadoggo-to-cargotoml">‚Äã</a></h3>
<p>The absolute first thing we need to do to use <code>aquadoggo</code> in any rust project is to add it as a dependency in our <code>Cargo.toml</code> file. We&#x27;ll need <code>p2panda-rs</code> for creating an identity for the node too so let&#x27;s add that now as well.</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">dependencies</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">p2panda-rs</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;0.8.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">aquadoggo</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;0.7.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>aquadoggo</code> crate gives us access to an API with which we can configure, start, migrate data to, and stop our node.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>What about publishing and querying data?</div><div class="admonitionContent_BuS1"><p>This is all done from the frontend code via the <code>GraphQL</code> API!</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="start-the-node">Start the node<a href="#start-the-node" class="hash-link" aria-label="Direct link to Start the node" title="Direct link to Start the node">‚Äã</a></h3>
<p>We can start a node like this:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">// We&#x27;re using `tokio::runtime` to make main async.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token attribute attr-name" style="color:#f2f0ec">#[tokio::main]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">main</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Generate a key pair for the node identity.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Construct a default configuration.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Start the node!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// The node is already started now, wait here on the blocking future `on_exit` which resolves when any of the node&#x27;s services exit with an</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// error or because of user closure.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Finally we call `shutdown` to gracefully close all remaining services, including database connections.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see the complete runtime life of a node in the above code, mostly it spends it&#x27;s time running in the background, responding to HTTP and GraphQL requests from clients, and replicating with other nodes. The main point of interest for this tutorial is how we wrap this simple code into a tauri app and configure the node at runtime.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tauri-integration">Tauri integration<a href="#tauri-integration" class="hash-link" aria-label="Direct link to Tauri integration" title="Direct link to Tauri integration">‚Äã</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="project-structure">Project structure<a href="#project-structure" class="hash-link" aria-label="Direct link to Project structure" title="Direct link to Project structure">‚Äã</a></h3>
<p>Let&#x27;s take a look into the project directory <code>src-tauri/</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îú‚îÄ‚îÄ build.rs</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îú‚îÄ‚îÄ Cargo.lock</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îú‚îÄ‚îÄ Cargo.toml</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îú‚îÄ‚îÄ icons</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îÇ¬†¬† ‚îî‚îÄ‚îÄ ...</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îú‚îÄ‚îÄ resources</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îÇ¬†¬† ‚îî‚îÄ‚îÄ ...</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îú‚îÄ‚îÄ src</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îÇ¬†¬† ‚îÇ‚îÄ‚îÄ main.rs</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îÇ¬†¬† ‚îî‚îÄ‚îÄ ...</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚îî‚îÄ‚îÄ Tauri.toml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To anyone who&#x27;s worked with the Rust programming language much of this will look very familiar. We have a <code>Cargo.toml</code> and <code>Cargo.lock</code> for managing dependencies, and a <code>src/</code> folder where our project code lives. Everything else here are Tauri specific conventions.</p>
<p>If you check the <code>Cargo.toml</code> file you&#x27;ll see that we&#x27;re importing the tauri crate as a dependency:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">dependencies</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">tauri</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;1.4&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token key property">features</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token string" style="color:#cc99cc">&quot;shell-open&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;config-toml&quot;</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Tauri has much more</div><div class="admonitionContent_BuS1"><p>There are many useful features of Tauri that we won&#x27;t touch on at all in this tutorial, checkout out the <a href="https://tauri.app/v1/guides/features/" target="_blank" rel="noopener noreferrer">&quot;features page&quot;</a> for more info.</p></div></div>
<p>And here is a brief explanation of the other files and folders used by the Tauri app:</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="buildrs"><code>build.rs</code><a href="#buildrs" class="hash-link" aria-label="Direct link to buildrs" title="Direct link to buildrs">‚Äã</a></h4>
<ul>
<li>the default tauri build file, we won&#x27;t do anything here in this tutorial.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="icons"><code>icons</code><a href="#icons" class="hash-link" aria-label="Direct link to icons" title="Direct link to icons">‚Äã</a></h4>
<ul>
<li>icons for your app in many platform specific shapes and sizes. We won&#x27;t do anything here in this tutorial check the tauri docs on how to <a href="https://tauri.app/v1/api/cli#icon" target="_blank" rel="noopener noreferrer">generate your own icons</a>.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resources"><code>resources/</code><a href="#resources" class="hash-link" aria-label="Direct link to resources" title="Direct link to resources">‚Äã</a></h4>
<ul>
<li>resources we want access to at application runtime can be placed here and retrieved via the tauri API.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tauritoml"><code>Tauri.toml</code><a href="#tauritoml" class="hash-link" aria-label="Direct link to tauritoml" title="Direct link to tauritoml">‚Äã</a></h4>
<ul>
<li>this is our Tauri app configuration file, there are many features with fine grained configurable options.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Where did all this come from?</div><div class="admonitionContent_BuS1"><p>You can scaffold a tauri project using their <code>create-tauri-app</code> tool which is available via <code>cargo</code>, <code>npm</code> and more. This very project was scaffolded in that way. More information on their <a href="https://tauri.app/v1/guides/getting-started/setup/" target="_blank" rel="noopener noreferrer">&quot;Quick Start&quot;</a> page.</p></div></div>
<p>Ok, let&#x27;s get into some code now, we&#x27;ll step through building a tauri app, starting our node and getting access to useful logs.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="build-the-tauri-app">Build the tauri app<a href="#build-the-tauri-app" class="hash-link" aria-label="Direct link to Build the tauri app" title="Direct link to Build the tauri app">‚Äã</a></h4>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc">// src/main.rs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">main</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Builder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">run</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token macro property">generate_context!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;error while running tauri application&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is the tauri builder, the code above builds an app which... doesn&#x27;t do anything... let&#x27;s already add our <code>aquadoggo</code>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="launching-aquadoggo">Launching <code>aquadoggo</code><a href="#launching-aquadoggo" class="hash-link" aria-label="Direct link to launching-aquadoggo" title="Direct link to launching-aquadoggo">‚Äã</a></h3>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc">// src/main.rs</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Setup handler where we launch our `aquadoggo` before the app starts.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">async_runtime</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">spawn</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">main</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Builder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token comment" style="color:#66cccc">// Add setup handler which launches our node before the app runs.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setup</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">run</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token macro property">generate_context!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;error while running tauri application&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will look very familiar to the example code for starting a node that we looked at earlier. The only change is that we are launching the node in it&#x27;s own async task from a setup handler which the Tauri app builder runs before the application starts. We will be doing more setup here in later steps.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-the-logs">Access the logs<a href="#access-the-logs" class="hash-link" aria-label="Direct link to Access the logs" title="Direct link to Access the logs">‚Äã</a></h3>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc">// src/main.rs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Setup handler where we launch our `aquadoggo` before the app starts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">async_runtime</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">spawn</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">main</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Enable logging if set via `RUST_LOG` environment variable.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">if</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">env</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">var</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;RUST_LOG&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">is_ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> _ </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token namespace">env_logger</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">builder</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">try_init</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Builder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setup</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">run</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token macro property">generate_context!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;error while running tauri application&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will want access to logs from our application and any important dependencies (especially from <code>aqaudoggo</code>) to do that we&#x27;re building a <code>Logger</code> instance which will capture and make available any logs bubbling up.</p>
<p>Now if we start the app, <code>aquadoggo</code> should launch in the background. We can access the logs to check this is happening correctly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run tauri dev</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    Finished dev </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token plain">unoptimized + debuginfo</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> target</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">in</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">42</span><span class="token plain">.59s</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Go to http://0.0.0.0:2020/graphql to use GraphQL playground</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Peer id: 12D3KooWFNVNAaR16ciUise7W2mMmodD993BDANE44q3NJehXTuz</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Node is listening on </span><span class="token number" style="color:#cc99cc">0.0</span><span class="token plain">.0.0:2022```</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::manager</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Start materializer </span><span class="token function" style="color:#66cccc;font-weight:bold">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::materializer::worker</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Register reduce worker with pool size </span><span class="token number" style="color:#cc99cc">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::materializer::worker</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Register dependency worker with pool size </span><span class="token number" style="color:#cc99cc">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::materializer::worker</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Register schema worker with pool size </span><span class="token number" style="color:#cc99cc">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::materializer::worker</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Register blob worker with pool size </span><span class="token number" style="color:#cc99cc">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::materializer::worker</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Register garbage_collection worker with pool size </span><span class="token number" style="color:#cc99cc">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::manager</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Start http </span><span class="token function" style="color:#66cccc;font-weight:bold">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::manager</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Start network </span><span class="token function" style="color:#66cccc;font-weight:bold">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::network::service</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Networking </span><span class="token function" style="color:#66cccc;font-weight:bold">service</span><span class="token plain"> initializing</span><span class="token punctuation" style="color:#f2f0ec">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::network::service</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Network </span><span class="token function" style="color:#66cccc;font-weight:bold">service</span><span class="token plain"> ready</span><span class="token operator" style="color:#f2f0ec">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token number" style="color:#cc99cc">2024</span><span class="token plain">-01-26T10:36:31Z INFO  aquadoggo::manager</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> Start replication </span><span class="token function" style="color:#66cccc;font-weight:bold">service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ok, that&#x27;s great! We&#x27;re already quite far. Next up is to start integrating some core Tauri features.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-webview">The <code>WebView</code><a href="#the-webview" class="hash-link" aria-label="Direct link to the-webview" title="Direct link to the-webview">‚Äã</a></h3>
<p>Let&#x27;s add a WebView to our app, this is where the client code and UI will be running:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Setup handler where we launch our `aquadoggo` before the app starts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Get a handle on the running application which gives us access to global state and</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// app configuration values.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">handle</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Build the WebView.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowBuilder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;main&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowUrl</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;index.html&quot;</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">into</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">resizable</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">fullscreen</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">inner_size</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token number" style="color:#cc99cc">800.0</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">600.0</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">title</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;p2panda-tauri-example&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">build</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">async_runtime</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">spawn</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="persistent-storage">Persistent storage<a href="#persistent-storage" class="hash-link" aria-label="Direct link to Persistent storage" title="Direct link to Persistent storage">‚Äã</a></h3>
<p>There are actually two places where application data will be persisted from, one is the backend where we are working now, this will be things like the <code>aquadoggo</code> identity, config and database, the other is from the frontend client code. When working in the browser we&#x27;re quite used to using LocalStorage to persist data between sessions. We use this very same pattern in Tauri, except we now have control over where and how this data is stored on the filesystem.</p>
<p>On a Linux platform the app data directory will be <code>~/.local/share/{identifier}</code> with <code>{identifier}</code> coming from your <code>Tauri.toml</code> configuration file:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Tauri.toml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">tauri.bundle</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">identifier</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;p2panda-tauri-example&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For our application we want both our WebView and node data to be persisted between app runs, and it would be nice if it was in the same location, so let&#x27;s configure it that way now.</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc">/// Utilities for key pairs.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">key_pair</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token plain">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Setup handler where we launch our `aquadoggo` before the app starts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Get a handle on the running application which gives us access to global state and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// app configuration values.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">handle</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Get the recommended app data directory.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app_data_dir </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">path_resolver</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;recommended app data dir is detected&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// If it doesn&#x27;t exist yet, create it now.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">if</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">!</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">is_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token class-name" style="color:#9ddab3">DirBuilder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">create</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">clone</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Build the WebView.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowBuilder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;main&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowUrl</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;index.html&quot;</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">into</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token comment" style="color:#66cccc">// Set the data directory for our WebView</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">data_directory</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">clone</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">resizable</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">fullscreen</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">inner_size</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token number" style="color:#cc99cc">800.0</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">600.0</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">title</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;p2panda-tauri-example&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">build</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Create a KeyPair or load it from private-key.txt file in app data directory.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">//</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// This key pair is used to identify the node on the network, it is not used for signing</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// any application data.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Set database url based on app data dir path.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    config</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">database_url </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token macro property">format!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token string" style="color:#cc99cc">&quot;sqlite:{}/db.sqlite3&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">to_str</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;invalid character in path&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Set blobs base path to app data dir.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    config</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">blobs_base_path </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Some</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">async_runtime</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">spawn</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There&#x27;s a bit more going on in <code>setup_handler</code> now. First we get a handle on the running app from which we can access global state and configuration values. From this we get the recommended app data directory path and create it if it doesn&#x27;t exist yet (it won&#x27;t if this is the first time the app is run). We then set the data directory for our <code>WebView</code>, load or generate a new keypair, configure node storage locations for our database and blobs.</p>
<p>We&#x27;re using a new crate module <code>key_pair</code> for the logic around loading or generating our node identity, we won&#x27;t look into that now as it&#x27;s not so interesting for this tutorial, but feel free to head over to <code>src/key_pair.rs</code> if you want to know more.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="node-configuration">Node configuration<a href="#node-configuration" class="hash-link" aria-label="Direct link to Node configuration" title="Direct link to Node configuration">‚Äã</a></h3>
<p>Now we have a running node which will persist app data between sessions, great! If you&#x27;ve checked out the <a href="/tutorials/aquadoggo">&quot;Set up a local node&quot;</a> tutorial then you&#x27;ll know there are many <code>aquadoggo</code> configurations to play with, and we will likely want users of our app to be able to decide some of these themselves.</p>
<p>The <code>aquadoggo</code> CLI can be configured via a <a href="https://github.com/p2panda/aquadoggo/blob/main/aquadoggo_cli/config.toml" target="_blank" rel="noopener noreferrer"><code>config.toml</code></a> file and we&#x27;re going to use the same approach in our Tauri app. We&#x27;ll take the following steps to do this:</p>
<ul>
<li>include a default <code>config.toml</code> in our apps <code>resources</code> and copy it into the app data directory on first start-up</li>
<li>load this file and configure our <code>aquadoggo</code> node with it when the app runs</li>
</ul>
<p>To do this we make use of the Tauri <code>resources</code> directory. We can see that this is configured in our <code>Tauri.toml</code> file like this:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Tauri.toml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">resources</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;resources/*&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Doing this means that any files in the <code>resources</code> directory will be bundled together with our app during compilation and we can access them via the <a href="https://docs.rs/tauri/1.5.4/tauri/struct.PathResolver.html#method.resolve_resource" target="_blank" rel="noopener noreferrer"><code>resolve_resource</code></a> method we get from the tauri crates <code>PathResolver</code>.</p>
<p>At this point we will also perform a little refactor as our app setup code is growing. We&#x27;ll introduce a new module <code>config</code> and export a method for handling all of the above. We won&#x27;t look into this module code in detail as it is fairly generic, see <code>src/config.rs</code> if you want to know more. We also add our default <code>config.toml</code> file to <code>resources/config.toml</code>. Our setup code now looks like this:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Utilities for node configuration.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">config</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">config</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> load_config</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">key_pair</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token plain">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Setup handler where we launch our `aquadoggo` before the app starts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">handle</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Getting and creating the app data directory has been refactored away here.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app_data_dir </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Manually construct the app WebView window as we want to set a custom data directory.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowBuilder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;main&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowUrl</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;index.html&quot;</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">into</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">data_directory</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">clone</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">resizable</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">fullscreen</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">inner_size</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token number" style="color:#cc99cc">800.0</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">600.0</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">title</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;p2panda-tauri-example&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">build</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Create a KeyPair or load it from private-key.txt file in app data directory.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// This key pair is used to identify the node on the network, it is not used for signing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// any application data.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Load the config from app data directory. If this is the first time the app is</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// being run then the default aquadoggo config file is copied into place and used.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">//</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Environment variables are also parsed and will take priority over values in the config</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// file.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">load_config</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">async_runtime</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">spawn</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>On a Linux platform the app config file will be located at <code>~/.local/share/{identifier}/config.toml</code>, the embedded node can now be configured by editing this file. Check out the <a href="https://github.com/p2panda/aquadoggo/tree/main/aquadoggo_cli" target="_blank" rel="noopener noreferrer">aquadoggo cli</a> repo for details on your many options.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>a GUI dashboard would be nice!</div><div class="admonitionContent_BuS1"><p>It&#x27;s true, you could build a very nice GUI dashboard for handling node configuration instead of manually editing a config file. We&#x27;d be excited to see anyone&#x27;s attempt at this ;-p</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="schema-migration">Schema migration<a href="#schema-migration" class="hash-link" aria-label="Direct link to Schema migration" title="Direct link to Schema migration">‚Äã</a></h3>
<p>Schemas are an important aspect of developing applications with p2panda and <code>aquadoggo</code>, they are how we define the shape of data we will be using in our application, and schema ids are how nodes communicate to each other which collections of documents they are interested in. When you build a local first p2panda application you are likely going to want to bundle these schema with your app, and publish them to your local node. If you want to know how to create a schema then at this point it&#x27;s worth looking through the <a href="/tutorials/fishy">&quot;Create a schema&quot;</a> tutorial, you can continue this tutorial without doing that though. It&#x27;s enough to know that we have a pre-generated <code>schema.lock</code> file which contains our schema, and we want to bundle this with our app and publish the contents of it to our node on startup. To do this we can use the <code>resources</code> folder and API again.</p>
<p>We will add our <code>schema.toml</code> and <code>schema.lock</code> files to the resources <code>resources/</code> folder.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Schema in the wild</div><div class="admonitionContent_BuS1"><p>Schema exist on a p2panda network in the same way that any other documents do, they are the result of publishing operations. Because of this, it&#x27;s possible to ambiently discover schema and start publishing documents following their form. We bundle them in this application here though as we already want to use the schema even if we&#x27;re offline or not connected to a network yet. It is however possible to rely on your peers to send you the schema as well.</p></div></div>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">config</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Utilities for schema.lock file.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">mod</span><span class="token plain"> </span><span class="token module-declaration namespace">schema</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token class-name" style="color:#9ddab3">Configuration</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">p2panda_rs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">identity</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">config</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> load_config</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">key_pair</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token plain">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">schema</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token plain">load_schema_lock</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Setup handler where we launch our `aquadoggo` before the app starts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">handle</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app_data_dir </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowBuilder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;main&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">WindowUrl</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;index.html&quot;</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">into</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">data_directory</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">clone</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">resizable</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">fullscreen</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">inner_size</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token number" style="color:#cc99cc">800.0</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token number" style="color:#cc99cc">600.0</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">title</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;p2panda-tauri-example&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">build</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> key_pair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">load_config</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Load the schema.lock file containing our app schema which will be published to the node.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> schema_lock </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">load_schema_lock</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">async_runtime</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">spawn</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> node </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">start</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">key_pair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token comment" style="color:#66cccc">// Migrate the app schemas, returns true if schema were migrated, false if no migration was required.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> did_migrate_schemas </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> node</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">migrate</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">schema_lock</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;failed to migrate app schema&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">if</span><span class="token plain"> did_migrate_schemas </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token macro property">println!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;Schema migration: app schemas successfully deployed on initial start-up&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">on_exit</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        node</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">shutdown</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token keyword" style="color:#ffcc66">await</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Show <code>schema.toml</code> file.</summary><div><div class="collapsibleContent_i85q"><div><p>This is the <code>schemas.toml</code> file used to generate our <code>schema.lock</code>:</p><div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># resources/schema.toml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">sprite_images</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;An image which can be assigned to a sprite&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">sprite_images.fields</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">blob</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;relation&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token key property">schema</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">id</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;blob_v1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">timestamp</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;int&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">sprites</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;A sprite which can be placed on a 2 dimensional plane&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">sprites.fields</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">img</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;relation&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token key property">schema</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;sprite_images&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">pos_x</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;int&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">pos_y</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;int&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">timestamp</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;int&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">colour</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details>
<p>Ok, we&#x27;re pretty much done with the setup code! We have a Tauri app that launches an <code>aquadoggo</code> in the background, configures it based on a <code>config.toml</code> file, persists app data to platform default storage location, and migrates relevant schema to the node on first startup. We really are ready to build a frontend client! This however, is now up to you now :-) there is a GraphQL API waiting to serve your app, you can publish data using the p2panda TypeScript SDK <code>shirokuma</code>, and any GraphQL client can be used for querying documents from the embedded node. Have a look at the tutorial <a href="/tutorials/mushroom-app">&quot;Let&#x27;s build a mushroom app&quot;</a> to learn more about client building.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>But what about the panda stickers?!</div><div class="admonitionContent_BuS1"><p>There is a JavaScript client app wrapped in this project of course, otherwise none of the clicky panda sticker fun would be possible. Have a look into the <code>src/</code> directory to explore the code. It&#x27;s a very simple client, but still demonstrates the powerful query API that our node is exploring. Int <code>scr/queries.js</code> you will find all the GraphQL queries the client uses, they make use of filtering, ordering and paginating document collections. Hopefully it demonstrates that thoughtful schema and query design can reduce the need for complex app logic greatly.</p></div></div>
<p>This tutorial is already growing quite long! But we still have a little more exciting bonus material to finish with.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tauri-commands">Tauri commands<a href="#tauri-commands" class="hash-link" aria-label="Direct link to Tauri commands" title="Direct link to Tauri commands">‚Äã</a></h3>
<p>Tauri commands allow you to define methods in your Rust code and automatically have them exposed in the client. We will use this now to communicate the <code>HTTP</code> port our node is using to the client app. This is just an example though, there could be many other uses for this feature.</p>
<p>What this looks like in the (heavily redacted) rust code:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">aquadoggo</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Node</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">async_runtime</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Manager</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">State</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">config</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> load_config</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">key_pair</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token plain">generate_or_load_key_pair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">crate</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token module-declaration namespace">schema</span><span class="token module-declaration namespace punctuation" style="color:#f2f0ec">::</span><span class="token plain">load_schema_lock</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">struct</span><span class="token plain"> </span><span class="token type-definition class-name" style="color:#9ddab3">HttpPort</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token keyword" style="color:#ffcc66">u16</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token attribute attr-name" style="color:#f2f0ec">#[tauri::command]</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">http_port_command</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">State</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token class-name" style="color:#9ddab3">HttpPort</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">u16</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    state</span><span class="token number" style="color:#cc99cc">.0</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token keyword" style="color:#ffcc66">mut</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">App</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Box</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token keyword" style="color:#ffcc66">dyn</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">error</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">+</span><span class="token plain"> </span><span class="token lifetime-annotation symbol">&#x27;static</span><span class="token operator" style="color:#f2f0ec">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">handle</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> app_data_dir </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> config </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">load_config</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token plain">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// Add the configured nodes http port to the app state so we can access it from the frontend.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">    app</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">manage</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token class-name" style="color:#9ddab3">HttpPort</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">http_port</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">main</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token comment" style="color:#66cccc">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Builder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">default</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setup</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">setup_handler</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">invoke_handler</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token macro property">generate_handler!</span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token plain">http_port_command</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">run</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token macro property">generate_context!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;error while running tauri application&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And then in the frontend you&#x27;d do something like this:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token keyword module" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#f2f0ec">{</span><span class="token imports"> invoke </span><span class="token imports punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;@tauri-apps/api/tauri&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#66cccc;font-weight:bold">init</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">HTTP_PORT</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#ffcc66">await</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">invoke</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&#x27;http_port_command&#x27;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="temp-app-storage-during-development">Temp app storage during development<a href="#temp-app-storage-during-development" class="hash-link" aria-label="Direct link to Temp app storage during development" title="Direct link to Temp app storage during development">‚Äã</a></h3>
<p>It was skimmed over in the code examples above, but during development we probably don&#x27;t want to persist our app data between each run, so when getting the recommended app data directory path we are first checking if we are actually in dev mode, and if so creating a tmp directory which will be used for all app data instead of the recommended filesystem paths. This is done like so:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc">// src/config.rs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">fs</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token keyword" style="color:#ffcc66">self</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">DirBuilder</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">path</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">PathBuf</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token namespace">sync</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">OnceLock</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">anyhow</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">tauri</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">AppHandle</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">use</span><span class="token plain"> </span><span class="token namespace">tempdir</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">TempDir</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">static</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">TMP_DIR</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">OnceLock</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token class-name" style="color:#9ddab3">TempDir</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">OnceLock</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// Get path to the current app data directory.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// If in dev mode app data is persisted to an ephemeral tmp folder. Otherwise app data path is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc">/// based on Tauri recommended defaults and app name defined in our Tauri.conf file.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#66cccc;font-weight:bold">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&amp;</span><span class="token class-name" style="color:#9ddab3">AppHandle</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Result</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token class-name" style="color:#9ddab3">PathBuf</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token namespace">anyhow</span><span class="token namespace punctuation" style="color:#f2f0ec">::</span><span class="token class-name" style="color:#9ddab3">Error</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> path </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">if</span><span class="token plain"> </span><span class="token macro property">cfg!</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">dev</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token constant" style="color:#6699cc">TMP_DIR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">get_or_init</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token closure-params closure-punctuation punctuation" style="color:#f2f0ec">|</span><span class="token closure-params closure-punctuation punctuation" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                </span><span class="token comment" style="color:#66cccc">// Initialise a `TempDir` instance globally to make sure it does not run out of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                </span><span class="token comment" style="color:#66cccc">// scope and gets deleted before the end of the application runtime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                </span><span class="token class-name" style="color:#9ddab3">TempDir</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;p2panda-tauri-example&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;Could not create temporary directory&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">path</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">to_path_buf</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">let</span><span class="token plain"> path </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> app</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">path_resolver</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">app_data_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">expect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&quot;recommended app data dir is detected&quot;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token comment" style="color:#66cccc">// Create app data directory if it doesn&#x27;t exist yet.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc66">if</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">!</span><span class="token plain">path</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">is_dir</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token class-name" style="color:#9ddab3">DirBuilder</span><span class="token punctuation" style="color:#f2f0ec">::</span><span class="token function" style="color:#66cccc;font-weight:bold">new</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">create</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">clone</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">?</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        path</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token class-name" style="color:#9ddab3">Ok</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="multiple-nodes--replication">Multiple nodes / replication<a href="#multiple-nodes--replication" class="hash-link" aria-label="Direct link to Multiple nodes / replication" title="Direct link to Multiple nodes / replication">‚Äã</a></h3>
<p>During development it&#x27;s really useful to be able to start many nodes and observe local discovery and replication of data. We built this into the p2panda Tauri boilerplate for you. To launch multiple app instances simple simple run the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Start a dev server for the client code which will be shared across app instances.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run dev</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># In a new terminal, launch an app instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run peer</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># In another new terminal, launch another app instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run peer</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># etc....</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Eventually you&#x27;ll will end up with something which looks like this:</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/p2panda/.github/main/assets/tauri-example-screenshot.png" alt="tauri example screenshot with many peers" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Why are there different color pandas?</div><div class="admonitionContent_BuS1"><p>Glad you asked! Panda color is deterministically generated from your clients public key ;-p this means we can see which authors published which pandas once data starts replicating around. Cool, right?!</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="multi-platform-compilation">Multi-platform compilation<a href="#multi-platform-compilation" class="hash-link" aria-label="Direct link to Multi-platform compilation" title="Direct link to Multi-platform compilation">‚Äã</a></h3>
<p>Last but absolutely not least, when the time comes, you will want to compile binaries for your application. And a big reason for using Tauri is the fact that it takes care of cross-compiling this very application for all major desktop operating systems (and soon mobile too).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="local-compilation">Local compilation<a href="#local-compilation" class="hash-link" aria-label="Direct link to Local compilation" title="Direct link to Local compilation">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run tauri build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will bundle your app for as a <code>.deb</code> file and as an <code>AppImage</code>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ci-bundle-release"><code>ci</code> bundle release<a href="#ci-bundle-release" class="hash-link" aria-label="Direct link to ci-bundle-release" title="Direct link to ci-bundle-release">‚Äã</a></h4>
<p>There is a <code>ci</code> task, triggered on pushing a new git tag, that compiles your app for all major desktop platforms and pushes the assets to a new github release. You can trigger this with the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Create a tag for this version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">git</span><span class="token plain"> tag v0.1.0</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Push the tag to github</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">git</span><span class="token plain"> push origin main </span><span class="token parameter variable" style="color:#f2f0ec">--tags</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ok, well done making it this far, that is really the end! Happy Tauri X p2panda hacking!!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-do-i-need" class="table-of-contents__link toc-highlight">What do I need?</a></li><li><a href="#download-the-application-code" class="table-of-contents__link toc-highlight">Download the application code</a></li><li><a href="#run-the-application" class="table-of-contents__link toc-highlight">Run the application</a></li><li><a href="#how-does-it-all-work" class="table-of-contents__link toc-highlight">How does it all work?</a></li><li><a href="#embedding-an-aquadoggo-node" class="table-of-contents__link toc-highlight">Embedding an <code>aquadoggo</code> node</a><ul><li><a href="#add-aquadoggo-to-cargotoml" class="table-of-contents__link toc-highlight">Add <code>aquadoggo</code> to <code>Cargo.toml</code></a></li><li><a href="#start-the-node" class="table-of-contents__link toc-highlight">Start the node</a></li></ul></li><li><a href="#tauri-integration" class="table-of-contents__link toc-highlight">Tauri integration</a><ul><li><a href="#project-structure" class="table-of-contents__link toc-highlight">Project structure</a></li><li><a href="#launching-aquadoggo" class="table-of-contents__link toc-highlight">Launching <code>aquadoggo</code></a></li><li><a href="#access-the-logs" class="table-of-contents__link toc-highlight">Access the logs</a></li><li><a href="#the-webview" class="table-of-contents__link toc-highlight">The <code>WebView</code></a></li><li><a href="#persistent-storage" class="table-of-contents__link toc-highlight">Persistent storage</a></li><li><a href="#node-configuration" class="table-of-contents__link toc-highlight">Node configuration</a></li><li><a href="#schema-migration" class="table-of-contents__link toc-highlight">Schema migration</a></li><li><a href="#tauri-commands" class="table-of-contents__link toc-highlight">Tauri commands</a></li><li><a href="#temp-app-storage-during-development" class="table-of-contents__link toc-highlight">Temp app storage during development</a></li><li><a href="#multiple-nodes--replication" class="table-of-contents__link toc-highlight">Multiple nodes / replication</a></li><li><a href="#multi-platform-compilation" class="table-of-contents__link toc-highlight">Multi-platform compilation</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer_J6tW"><img class="footer-img__0Xc" src="/images/deepsea-panda.svg" width="100"><div><img class="supporters-img_P2oV" src="/images/nlnet-logo.svg" width="140"><img class="supporters-img_P2oV" src="/images/ngi-logo.png" width="200"><img class="supporters-img_P2oV" src="/images/eu-flag-logo.png" width="78"><p class="footer-text_MXRq">This project has received funding from the European Union‚Äôs Horizon 2020 research and innovation programme within the framework of the NGI-POINTER Project funded under grant agreement No 871528, NGI-ASSURE No 957073 and NGI0-ENTRUST No 101069594</p></div><p class="footer-text_MXRq">CC BY-SA 4.0<!-- --> - <a href="/contact">Contact</a> -<!-- --> <a href="https://autonomous.zone/@p2panda" target="_blank" rel="noreferrer">Fediverse</a></p></footer></div>
</body>
</html>