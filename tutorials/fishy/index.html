<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/fishy" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Tutorial: Create a schema | p2panda</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://p2panda.org/tutorials/fishy"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tutorial: Create a schema | p2panda"><meta data-rh="true" name="description" content="In this tutorial we want to register a new schema using the fishy command line tool and aquadoggo node."><meta data-rh="true" property="og:description" content="In this tutorial we want to register a new schema using the fishy command line tool and aquadoggo node."><link data-rh="true" rel="icon" href="/images/deepsea-panda.svg"><link data-rh="true" rel="canonical" href="https://p2panda.org/tutorials/fishy"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/fishy" hreflang="en"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/fishy" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="p2panda News RSS Feed"><link rel="stylesheet" href="/assets/css/styles.862b1275.css">
<script src="/assets/js/runtime~main.d75b26e2.js" defer="defer"></script>
<script src="/assets/js/main.97848bd4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="navbar__brand"><div class="navbar__logo"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></div></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/learn/">Learn</a><a class="navbar__item navbar__link" href="/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/sdks/">SDKs</a><a class="navbar__item navbar__link" href="/specifications/">Specifications</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/links">Links</a><a class="navbar__item navbar__link" href="/contact">Contact</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tutorial: Create a schema</h1></header><p>In this tutorial we want to register a new schema using the <a href="https://github.com/p2panda/fishy" target="_blank" rel="noopener noreferrer"><code>fishy</code></a> command line tool and <a href="https://github.com/p2panda/aquadoggo" target="_blank" rel="noopener noreferrer"><code>aquadoggo</code></a> node.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-do-i-need">What do I need?<a href="#what-do-i-need" class="hash-link" aria-label="Direct link to What do I need?" title="Direct link to What do I need?">​</a></h2>
<ul>
<li>Editor</li>
<li>Terminal</li>
<li>Browser</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-is-fishy">What is <code>fishy</code>?<a href="#what-is-fishy" class="hash-link" aria-label="Direct link to what-is-fishy" title="Direct link to what-is-fishy">​</a></h2>
<p><code>fishy</code> is a command-line-tool for creating and publishing schema onto the p2panda network. It allows you to define collections of schema in a human readable <code>toml</code> file and then encodes the schema in the correct format for publishing directly to a node, sharing via other channels, or embedding in an application.</p>
<p>We&#x27;ll go through the steps one at a time below, for now just know that <code>fishy</code> is your friend when it comes to creating schema for your application.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="install-fishy">Install <code>fishy</code><a href="#install-fishy" class="hash-link" aria-label="Direct link to install-fishy" title="Direct link to install-fishy">​</a></h3>
<p>Head over to the <a href="https://github.com/p2panda/fishy/releases" target="_blank" rel="noopener noreferrer">Releases</a> page and download the pre-compiled binary for your platform. This tutorial was written using <code>v0.2.1</code>.</p>
<p>Or on the command line:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#f2f0ec">-L</span><span class="token plain"> https://github.com/p2panda/fishy/releases/download/v0.2.1/fishy-v0.2.1-x86_64-unknown-linux-gnu.tar.gz </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">tar</span><span class="token plain"> </span><span class="token parameter variable" style="color:#f2f0ec">-xz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the rest of the tutorial we will run fishy simply using the command <code>./fishy</code>. If required, in your own commands adjust this to match the name of the binary you downloaded or rename it to accordingly.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-is-aquadoggo">What is <code>aquadoggo</code>?<a href="#what-is-aquadoggo" class="hash-link" aria-label="Direct link to what-is-aquadoggo" title="Direct link to what-is-aquadoggo">​</a></h2>
<p><code>aquadoggo</code> is a p2panda node implementation and command-line-tool, it&#x27;s our gateway into the p2panda network. You can learn more about it in the <a href="/tutorials/aquadoggo">Set up a local node</a> tutorial.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="install-aquadoggo">Install <code>aquadoggo</code><a href="#install-aquadoggo" class="hash-link" aria-label="Direct link to install-aquadoggo" title="Direct link to install-aquadoggo">​</a></h3>
<p>Head over to the <a href="https://github.com/p2panda/aquadoggo/releases" target="_blank" rel="noopener noreferrer">Releases</a> page and download the pre-compiled binary for your platform. This tutorial was written using <code>v0.7.0</code>.</p>
<p>Or on the command line:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#f2f0ec">-L</span><span class="token plain"> https://github.com/p2panda/aquadoggo/releases/download/v0.7.0/aquadoggo-v0.7.0-x86_64-unknown-linux-gnu.tar.gz </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">tar</span><span class="token plain"> </span><span class="token parameter variable" style="color:#f2f0ec">-xz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the rest of the tutorial we will run aquadoggo simply using the command <code>./aquadoggo</code>. If required, in your own commands adjust this to match the name of the binary you downloaded or rename it to accordingly.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-schema">Create a Schema<a href="#create-a-schema" class="hash-link" aria-label="Direct link to Create a Schema" title="Direct link to Create a Schema">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">🐼</span></span>When/why do we create schema?</div><div class="admonitionContent_BuS1"><p>All <code>p2panda</code> applications will have a collection of schema which they require, for example, a blog might need <code>blogs</code>, <code>blog_posts</code> and <code>comments</code>, these schema describe the shape of the documents the application will handle. <code>aquadoggo</code> looks at these schema to build an API which fits your use and to decide what data to look for on the network.</p><p>Creating and publishing schema might well be the first step you take when building an application, once you&#x27;ve done this you will have a very useful <code>GraphQl</code> interface available for publishing and querying data to/from the network.</p></div></div>
<p>Ok, we want to create our own schema. To get the process started, make sure you&#x27;re in the <code>fishy</code> directory and then run the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">./fishy init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A dialogue will ask you for the name of your first schema. Enter a name, for example &quot;cafes&quot; and press <code>enter</code> (don&#x27;t worry, you can change this later). You will now find a <code>schema.toml</code> and <code>secret.txt</code> file in your folder.</p>
<p>The <code>schema.toml</code> contains some example schema definitions which we will edit in a moment, the <code>secret.txt</code> contains the private key which will be used for signing commits when building the schema.</p>
<p><code>schema.toml</code> is where we define our schema, with any text editor edit the file so it contains the following definition:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">cafes</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;All the cafes where icecream is sold&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">cafes.fields</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">address</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">opening_year</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;int&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">icecreams</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;Icecream flavours you can get in cafes&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">icecreams.fields</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">sweetness</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">cafes</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;relation_list&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token key property">schema</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;cafes&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There&#x27;s a lot going on here! We&#x27;re defining two schema, <code>cafe</code> and <code>icecream</code>, they both have a <code>description</code> string and a list of <code>fields</code>. The <code>description</code> is required and at least one <code>field</code> must be defined for each schema.</p>
<p>The list of fields describe key-value pairs comprising of the field name, and it&#x27;s type. Each key will be the fields name, it can be any string as long as it follows the <a href="/specifications/aquadoggo/data-types/schemas">naming rules</a>. The type object of each item indicates the fields type. Possible types are:</p>
<ul>
<li><code>int</code>, which is an integer number (<code>i64</code>).</li>
<li><code>float</code>, which is a float number (<code>f64</code>).</li>
<li><code>bool</code>, which can be <code>true</code> or <code>false</code>.</li>
<li><code>str</code>, which can be any sort of text.</li>
</ul>
<p>.. and now it gets interesting, there is even more:</p>
<ul>
<li><code>relation</code>, which can be a reference to another document.</li>
<li><code>relation_list</code>, which can be a list of references to many documents!</li>
<li><code>pinned_relation</code>, which can be a reference to a <em>document view</em>. This is a document in a past, historical version. Like an <em>archived</em> version you wanted to keep.</li>
<li><code>pinned_relation_list</code>, which is a list of document views!</li>
</ul>
<p>If we look at the <code>cafes</code> field in our <code>[icecreams.fields]</code> list, you can see that there is an additional <code>schema</code> value in the field type object. This indicates that any documents which are related to in the <code>cafes</code> field will be of the type <code>cafes</code>, the name used here refers to the schema defined earlier in the file.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">🐼</span></span>Why relations?</div><div class="admonitionContent_BuS1"><p>One benefit of defining relations between schemas is that the node&#x27;s query API becomes even more powerful. If I want to check all the cafes where my favorite ice cream flavours are sold, I can write the following query:</p><div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token property">all_</span><span class="token plain">&lt;</span><span class="token constant" style="color:#6699cc">ICECREAMS_SCHEMA_ID</span><span class="token plain">&gt; </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token object">documents</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token object">fields</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">sweetness</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token object">cafes</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">          </span><span class="token object">documents</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token object">fields</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              </span><span class="token property">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              </span><span class="token property">address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              </span><span class="token property">opening_year</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">          </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can write nested queries like this because we defined a relation between <code>icecreams</code> and <code>cafes</code>!!</p></div></div>
<p>You can build the schema and commit them to <code>schema.lock</code> by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">./fishy build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This should output a result which looks very similar to this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">fishy: Create operations and sign entries to update schema</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- schema_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/icecream_schema.toml</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- lock_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/schema.lock</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- private_key_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/secret.txt</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">The following changes </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">add, change, remove</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> will be applied:</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">cafes_002092aa71ef4d4b52bd082c15b208d4c1aa7134181beb0e5f75542f794717d10617</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Name: cafes</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Description: </span><span class="token string" style="color:#cc99cc">&quot;All the cafes where icecream is sold&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╭───┬──────────────┬────────────╮</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token comment" style="color:#66cccc"># ┆ Field Name   ┆ Field Type │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╞═══╪══════════════╪════════════╡</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token number" style="color:#cc99cc">1</span><span class="token plain"> ┆ opening_year ┆ int        │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token number" style="color:#cc99cc">2</span><span class="token plain"> ┆ address      ┆ str        │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token number" style="color:#cc99cc">3</span><span class="token plain"> ┆ name         ┆ str        │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╰───┴──────────────┴────────────╯</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">icecreams_0020fe08a0b2f3a7f395df580db551c823e73e9936420ece7c5eae5a27b8d71c8632</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Name: icecreams</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Description: </span><span class="token string" style="color:#cc99cc">&quot;Icecream flavours you can get in cafes&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╭───┬────────────┬──────────────────────╮</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token comment" style="color:#66cccc"># ┆ Field Name ┆ Field Type           │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╞═══╪════════════╪══════════════════════╡</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token number" style="color:#cc99cc">1</span><span class="token plain"> ┆ name       ┆ str                  │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token number" style="color:#cc99cc">2</span><span class="token plain"> ┆ cafes      ┆ relation_list</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">cafes</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ </span><span class="token number" style="color:#cc99cc">3</span><span class="token plain"> ┆ sweetness  ┆ str                  │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╰───┴────────────┴──────────────────────╯</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Public key used </span><span class="token keyword" style="color:#ffcc66">for</span><span class="token plain"> signing: 8e4e1af5417f64306862b123ab621739f025449e0da23dc0e1049e88cc2569cb</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Do you want to commit these changes </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token number" style="color:#cc99cc">8</span><span class="token plain"> total</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain">? </span><span class="token function" style="color:#66cccc;font-weight:bold">yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>fishy</code> will automatically show you the changes which will be committed and ask for your confirmation. Hit <code>y</code> to confirm.</p>
<p>So, what just happened? <code>fishy</code> looked at the schema definitions in <code>schema.toml</code> and then created, signed and encoded entries containing the schema definitions for us. This version of the schema now lives in <code>schema.lock</code>. It contains entries which are ready to be published to a node.</p>
<p>The printed output also gives us some useful information, as well as outlining the fields of the schema we just created, it tells us the <code>schema_id</code> (eg. <code>icecreams_0020fe08a0b2f3a7f395df580db551c823e73e9936420ece7c5eae5a27b8d71c8632</code>) and the public key of the signing author.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="start-node">Start node<a href="#start-node" class="hash-link" aria-label="Direct link to Start node" title="Direct link to Start node">​</a></h2>
<p>In a moment we&#x27;ll be publishing schema to a node, let&#x27;s start it now so it&#x27;s ready when we need it.</p>
<p>In a new terminal (making sure you&#x27;re in the directory where you downloaded <code>aquadoggo</code> earlier) run the following command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">./aquadoggo --log-level</span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain">info</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the following output (as well as some additional info logging omitted for brevity):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">                       ██████ ███████ ████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                      ████████       █████  █</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                      ██████            ███</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                       █████              ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                       █     ████      █████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                      █     ██████   █ █████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                     ██      ████   ███ █████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                    █████         ██████    █</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                   ███████                ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                   █████████   █████████████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                   ███████████      █████████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                   █████████████████         ████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              ██████    ███████████              ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">          ██████████        █████                 █</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">           █████████        ██          ███       ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">             ██████        █            █           ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">                ██       ██             ███████     ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              ███████████                      ██████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">████████     ████████████                   ██████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">████   ██████ ██████████            █   ████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  █████████   ████████       ███    ███████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    ████████             ██████    ████████</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">█████████  ████████████████████████   ███</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">█████████                      ██</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">aquadoggo v0.7.0</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">No config file provided</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Configuration</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Allow schema IDs: * (any schema id)</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Database URL: memory (data is not persisted)</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">mDNS: enabled</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Private key: ephemeral (not persisted)</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Relay mode: disabled</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Node is ready!</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Go to http://0.0.0.0:2020/graphql to use GraphQL playground</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Peer id: 12D3KooWEWfho5JPyoWn97V2Zn7JFYcepA4CV1Dsb5tFRWyzoG9g</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Node is listening on 0.0.0.0:2022</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now you have a local node running on port <code>2020</code>. You can check if everything is alright by opening your browser and surfing to <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a>, do you see the GraphQL playground? Super. Let&#x27;s play with it soon!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deploy-a-schema">Deploy a Schema<a href="#deploy-a-schema" class="hash-link" aria-label="Direct link to Deploy a Schema" title="Direct link to Deploy a Schema">​</a></h2>
<p>The operations for our schema currently live in the <code>schema.lock</code> file, but actually we want them on our <code>aquadoggo</code> node. For this we use another <code>fishy</code> command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">./fishy deploy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the following output from <code>fishy</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">fishy: Deploy created schemas on a node</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- lock_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/schema.lock</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- endpoint: http://localhost:2020/graphql</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">████████████████████████████████████████████████████████████████████████████████████████████████████████████ 8/8</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Successfully deployed 8 commits on node (ignored 0).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Interestingly, if you check the logs of your running <code>aquadoggo</code> node then you can see this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[2024-01-22T13:08:39Z INFO  aquadoggo::schema::schema_provider] Updating cafes d10617</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">[2024-01-22T13:08:39Z INFO  aquadoggo::graphql::schema] Changed schema cafes d10617, rebuilding GraphQL API</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">[2024-01-22T13:08:39Z INFO  aquadoggo::schema::schema_provider] Updating icecreams 1c8632</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">[2024-01-22T13:08:39Z INFO  aquadoggo::graphql::schema] Changed schema icecreams 1c8632, rebuilding GraphQL API</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can see that the node received the published schema and automatically re-built the GraphQL API for us.</p>
<p>You can now visit <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a> to see your new schema as well as the dynamically constructed query endpoints!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="querying-icecreams-documents">Querying <code>icecreams</code> documents<a href="#querying-icecreams-documents" class="hash-link" aria-label="Direct link to querying-icecreams-documents" title="Direct link to querying-icecreams-documents">​</a></h2>
<p>We&#x27;ve created a new field now, so we can also directly inspect it via the GraphQL playground of the <code>aquadoggo</code> node. For this you can just surf to <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a> and run the following query, replacing ICECREAMS_SCHEMA_ID with the schema id output when you ran <code>deploy</code> earlier:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token property">all_</span><span class="token plain">&lt;</span><span class="token constant" style="color:#6699cc">ICECREAMS_SCHEMA_ID</span><span class="token plain">&gt; </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token object">documents</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token object">fields</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">sweetness</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token object">cafes</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">          </span><span class="token object">documents</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token object">fields</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              </span><span class="token property">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              </span><span class="token property">address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">              </span><span class="token property">opening_year</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">            </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">          </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Of course, this query won&#x27;t return any results because we didn&#x27;t create any <code>cafes</code> or <code>icecreams</code> documents yet. So let&#x27;s publish some!</p>
<p>Using the form below you can publish a cafe documents to your local node. Take the schema id which fishy output after you created your <code>cafes</code> schema earlier (eg <code>cafes_002092aa71ef4d4b52bd082c15b208d4c1aa7134181beb0e5f75542f794717d10617</code>) and assign it to the <code>schemaId</code> value in the code editor below. Then try clicking <code>Create</code>. It should publish a cafe document to your local node!!</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">🐼</span></span>info</div><div class="admonitionContent_BuS1"><p>The code below is using <code>Session</code> which is imported from our TypeScript SDK <code>shirokuma</code> and helps handle your clients connection to a node. It&#x27;s outside the scope of this tutorial to go into detail on document creation, but check-out the <a href="/tutorials/mushroom-app">Let&#x27;s build a mushroom app!</a> tutorial on publishing data using <a href="https://github.com/p2panda/shirokuma" target="_blank" rel="noopener noreferrer"><code>shirokuma</code></a> or try out our tiny CLI client <a href="https://github.com/p2panda/send-to-node" target="_blank" rel="noopener noreferrer"><code>send-to-node</code></a>.</p></div></div>
<div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">Live Editor</div><div class="playgroundEditor_Q6Y7"><pre class="prism-code language-tsx" style="margin:0;outline:none;padding:10px;font-family:inherit;color:#d3d0c8;background-color:#2d2d2d" spellcheck="false"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">function</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">CafeApp</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#66cccc;font-weight:bold">createCafe</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">session</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> values</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"> session</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token method function property-access" style="color:#66cccc;font-weight:bold">create</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">values</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      endpoint</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;http://localhost:2020/graphql&#x27;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      schemaId</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;&#x27;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token comment" style="color:#66cccc">// 👈 change this to your own schema id.</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8">
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token tag punctuation" style="color:#f2f0ec">&lt;</span><span class="token tag class-name" style="color:#9ddab3">App</span><span class="token tag" style="color:#f2f0ec"> </span><span class="token tag attr-name" style="color:#f2f0ec">header</span><span class="token tag attr-value punctuation attr-equals" style="color:#f2f0ec">=</span><span class="token tag attr-value punctuation" style="color:#f2f0ec">&quot;</span><span class="token tag attr-value" style="color:#cc99cc">🐼 🍦</span><span class="token tag attr-value punctuation" style="color:#f2f0ec">&quot;</span><span class="token tag" style="color:#f2f0ec"> </span><span class="token tag attr-name" style="color:#f2f0ec">sayHello</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#f2f0ec">=</span><span class="token tag script language-javascript punctuation" style="color:#f2f0ec">{</span><span class="token tag script language-javascript boolean" style="color:#f2f0ec">true</span><span class="token tag script language-javascript punctuation" style="color:#f2f0ec">}</span><span class="token tag punctuation" style="color:#f2f0ec">&gt;</span><span class="token plain-text"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#f2f0ec">&lt;</span><span class="token tag class-name" style="color:#9ddab3">CafeForm</span><span class="token tag" style="color:#f2f0ec"> </span><span class="token tag attr-name" style="color:#f2f0ec">createCafe</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#f2f0ec">=</span><span class="token tag script language-javascript punctuation" style="color:#f2f0ec">{</span><span class="token tag script language-javascript" style="color:#f2f0ec">createCafe</span><span class="token tag script language-javascript punctuation" style="color:#f2f0ec">}</span><span class="token tag punctuation" style="color:#f2f0ec">&gt;</span><span class="token tag punctuation" style="color:#f2f0ec">&lt;/</span><span class="token tag class-name" style="color:#9ddab3">CafeForm</span><span class="token tag punctuation" style="color:#f2f0ec">&gt;</span><span class="token plain-text"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#f2f0ec">&lt;/</span><span class="token tag class-name" style="color:#9ddab3">App</span><span class="token tag punctuation" style="color:#f2f0ec">&gt;</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span>
</span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span>
</span></pre></div><div class="playgroundHeader_dyrN">Result</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div></div>
<p>You can now query your cafes in the graphql playground like so:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token property">all_</span><span class="token plain">&lt;</span><span class="token constant" style="color:#6699cc">CAFES_SCHEMA_ID</span><span class="token plain">&gt; </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token object">documents</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token object">fields</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">opening_year</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token object">meta</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token property">documentId</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bonus-round-updating-a-schema">Bonus Round: Updating a schema<a href="#bonus-round-updating-a-schema" class="hash-link" aria-label="Direct link to Bonus Round: Updating a schema" title="Direct link to Bonus Round: Updating a schema">​</a></h2>
<p>It is also possible to update an existing schema using <code>fishy</code>. To do this, first open the <code>schema.toml</code> file in your editor and add a <code>rating</code> field to the <code>icecreams</code> schema.</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">cafes</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;All the cafes where icecream is sold&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">cafes.fields</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">address</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">opening_year</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;int&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">icecreams</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;Icecream flavours you can get in cafes&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token table class-name" style="color:#9ddab3">icecreams.fields</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">sweetness</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;str&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">rating</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;float&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token key property">cafes</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;relation_list&quot;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token key property">schema</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&quot;cafes&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To update the schema we run the <code>build</code> command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">./fishy build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output will tell us what changes are to be applied and check if we want to proceed:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">fishy: Create operations and sign entries to update schema</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- schema_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/icecream_schema.toml</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- lock_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/schema.lock</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">- private_key_path: /home/sandreae/Code/mushroom-app-tutorial/schemas/secret.txt</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">The following changes (add, change, remove) will be applied:</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">icecreams_00203a83b21416a852089d66f6c9c79c7ec4ddb74234d74b51d4d4535358c4342905</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Previously: icecreams_0020fe08a0b2f3a7f395df580db551c823e73e9936420ece7c5eae5a27b8d71c8632</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Name: icecreams</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Description: &quot;Icecream flavours you can get in cafes&quot;</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╭───┬────────────┬──────────────────────╮</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ # ┆ Field Name ┆ Field Type           │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╞═══╪════════════╪══════════════════════╡</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ 1 ┆ name       ┆ str                  │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ 2 ┆ cafes      ┆ relation_list(cafes) │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ 3 ┆ rating     ┆ float                │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">├╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">│ 4 ┆ sweetness  ┆ str                  │</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">╰───┴────────────┴──────────────────────╯</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Public key used for signing: 8e4e1af5417f64306862b123ab621739f025449e0da23dc0e1049e88cc2569cb</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Do you want to commit these changes (2 total)? [y/n]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(in the actual output the changes are highlighted in nice colours....)</p>
<p>Confirming here will update the <code>schema.lock</code> file, then all we need to do is <code>deploy</code> again:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">./fishy deploy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you once again check <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a> you can see that both our original and updated <code>icecreams</code> schema are now in the GraphQL API. These two schema are views onto the same schema document in it&#x27;s original and updated state.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-do-i-need" class="table-of-contents__link toc-highlight">What do I need?</a></li><li><a href="#what-is-fishy" class="table-of-contents__link toc-highlight">What is <code>fishy</code>?</a><ul><li><a href="#install-fishy" class="table-of-contents__link toc-highlight">Install <code>fishy</code></a></li></ul></li><li><a href="#what-is-aquadoggo" class="table-of-contents__link toc-highlight">What is <code>aquadoggo</code>?</a><ul><li><a href="#install-aquadoggo" class="table-of-contents__link toc-highlight">Install <code>aquadoggo</code></a></li></ul></li><li><a href="#create-a-schema" class="table-of-contents__link toc-highlight">Create a Schema</a></li><li><a href="#start-node" class="table-of-contents__link toc-highlight">Start node</a></li><li><a href="#deploy-a-schema" class="table-of-contents__link toc-highlight">Deploy a Schema</a></li><li><a href="#querying-icecreams-documents" class="table-of-contents__link toc-highlight">Querying <code>icecreams</code> documents</a></li><li><a href="#bonus-round-updating-a-schema" class="table-of-contents__link toc-highlight">Bonus Round: Updating a schema</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_J6tW"><img class="footer-img__0Xc" src="/images/deepsea-panda.svg" width="100"><div><img class="supporters-img_P2oV" src="/images/nlnet-logo.svg" width="140"><img class="supporters-img_P2oV" src="/images/ngi-logo.png" width="200"><img class="supporters-img_P2oV" src="/images/eu-flag-logo.png" width="78"><p class="footer-text_MXRq">This project has received funding from the European Union’s Horizon 2020 research and innovation programme within the framework of the NGI-POINTER Project funded under grant agreement No 871528, NGI-ASSURE No 957073 and NGI0-ENTRUST No 101069594</p></div><p class="footer-text_MXRq">CC BY-SA 4.0<!-- --> - <a href="/contact">Contact</a> -<!-- --> <a href="https://autonomous.zone/@p2panda" target="_blank" rel="noreferrer">Fediverse</a></p></footer></div>
</body>
</html>