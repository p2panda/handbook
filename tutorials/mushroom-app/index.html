<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/mushroom-app" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Tutorial: Let&#x27;s build a mushroom app! | p2panda</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://p2panda.org/tutorials/mushroom-app"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tutorial: Let&#x27;s build a mushroom app! | p2panda"><meta data-rh="true" name="description" content="In this tutorial we will build an web app for finding and identifying mushrooms using p2panda. We will build the application with React, Webpack and TypeScript."><meta data-rh="true" property="og:description" content="In this tutorial we will build an web app for finding and identifying mushrooms using p2panda. We will build the application with React, Webpack and TypeScript."><link data-rh="true" rel="icon" href="/images/deepsea-panda.svg"><link data-rh="true" rel="canonical" href="https://p2panda.org/tutorials/mushroom-app"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/mushroom-app" hreflang="en"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/mushroom-app" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.24eb0613.css">
<script src="/assets/js/runtime~main.80f831be.js" defer="defer"></script>
<script src="/assets/js/main.cb55a316.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="navbar__brand"><div class="navbar__logo"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></div></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/learn/">Learn</a><a class="navbar__item navbar__link" href="/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/sdks/">SDKs</a><a class="navbar__item navbar__link" href="/specifications/">Specifications</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/links">Links</a><a class="navbar__item navbar__link" href="/contact">Contact</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tutorial: Let&#x27;s build a mushroom app!</h1></header><p>In this tutorial we will build an web app for finding and identifying mushrooms using p2panda. We will build the application with <a href="https://reactjs.org/" target="_blank" rel="noopener noreferrer">React</a>, <a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">Webpack</a> and <a href="https://www.typescriptlang.org/" target="_blank" rel="noopener noreferrer">TypeScript</a>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>This is not a React tutorial</div><div class="admonitionContent_BuS1"><p>This tutorial assumes that you already have experience in using npm, React, Webpack and TypeScript. We want to rather focus on <em>using</em> the JavaScript library <code>shirokuma</code> (which is a user-friendly wrapper around <code>p2panda-js</code>). That being said, if you are a beginner, this is also for you as most of the code has already been written!</p></div></div>
<p>The idea of the application is inspired by <a href="https://plantnet.org" target="_blank" rel="noopener noreferrer">PlantNet</a>: Users can create entries of different mushrooms to create some sort of community-run encyclopaedia. If you&#x27;re around in the forest you can take a picture of a spotted mushroom, give it a GPS position and mark it with the mushroom database entry you <em>think</em> it might be. You can even select multiple mushrooms if you are not sure. The uploaded pictures of all users will show up in some sort of feed.</p>
<div class="image-frame_fg61"><div class="image-frame-inner_Xabn"><div style="background-size:cover;background-repeat:no-repeat;position:relative;background-image:url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMCAIAAADUCbv3AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZElEQVR4nD3OPUsCYQDA8fsMLX2BGiKcWtoaigjLF6JAqCUiDFqCahQaEpoKNxsdIzASGoLSCgqvkNBCvQrj9DzPu+e557l7Xu7yrTCq+ccf/kIeGHVuVRmWKcpJpTfxsUpMmWHVsZ6AIRQNTUMNBao1o/4uy1Llo6orNVDXzEZBU4UygrhlA9eCDqnqWIEIugS4lt0iRRMIEjbtNsEdqph6Opt7eC41KUYtQju0hKAgYch6XEHaUfwwkYgHAv5weAW36R8jyL9c2VCiuzuVYuY4cbAcCqo24F9OCYE+0y7XKQz6pqORjctkbGtzrYaazj+TLoOOteCbHxkenZ2cWgwGDY5Zj/0whqRDAbfK8r2YvciLV+JdRmc267LfNdJh5ifaj/hj60Pne+Mhr6df9xkIrxjyngO4ueQdW50Y2J4bDM14UMt2elxCUHiBQHftOsXXtzdnqdRJ8jSdSasMA9cuAOMbV+4iaZrsIZ8AAAAASUVORK5CYII=&quot;)"><svg style="width:100%;height:auto;max-width:100%;margin-bottom:-4px" width="808" height="1000"></svg><noscript><img style="width:100%;height:auto;max-width:100%;margin-bottom:-4px;position:absolute;top:0;left:0" src="/assets/ideal-img/mushroom-app.fdf2308.808.png" srcset="/assets/ideal-img/mushroom-app.fdf2308.808.png 808w" alt="This is how the app looks like" width="808" height="1000"></noscript></div></div><div class="image-frame-title_UNlE">This is how the app looks like</div></div>
<p>Of course this is a very simple mushrooming app and we can think of many cool features already now: Like users giving comments on your findings, rating them and even giving suggestions / votes which mushroom it can be - or you could show a world map of all mushroom findings with the help of the GPS positions. Or you can delete findings if they are wrong! All of this is possible with p2panda, you can hack on it if you want after reading this tutorial.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Visual identification of mushrooms</div><div class="admonitionContent_BuS1"><p>All cool polar mushroom animals know that it is not always possible to identify mushrooms based on pictures. There are many other factors as well: The smell, the colour of the spores, the surroundings, time of the year, change of colour after rain and more! Sometimes you even need a microscope to see the spores - to really be sure.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-do-i-need">What do I need?<a href="#what-do-i-need" class="hash-link" aria-label="Direct link to What do I need?" title="Direct link to What do I need?">‚Äã</a></h2>
<ul>
<li>NodeJS</li>
<li>Editor</li>
<li>Terminal</li>
<li>Browser</li>
</ul>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>How do I install NodeJS?</summary><div><div class="collapsibleContent_i85q"><div><p>You can check out the official <a href="https://nodejs.org/en/download/package-manager/" target="_blank" rel="noopener noreferrer">Installing Node.js via package manager</a> guidelines here. But we would recommend you installing a NodeJS version manager like <a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener noreferrer">nvm</a>, or even better <a href="https://github.com/tj/n" target="_blank" rel="noopener noreferrer">n</a>. We used the NodeJS version <code>18.8.0</code> for this tutorial.</p></div></div></div></details>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="start-node">Start node<a href="#start-node" class="hash-link" aria-label="Direct link to Start node" title="Direct link to Start node">‚Äã</a></h2>
<p>Every p2panda client needs a node to talk to, so let&#x27;s start one! You can follow the <a href="/tutorials/aquadoggo">Set up a local node</a> tutorial to learn how to compile a node yourself, but for this tutorial we are going to use a pre-compiled binaries.</p>
<p>Visit the <a href="https://github.com/p2panda/aquadoggo/releases" target="_blank" rel="noopener noreferrer">releases</a> page on the <code>aquadoggo</code> github repository and download the binary compiled for your system and unpack in a directory of your choice. In the command line, navigate to the directory where the <code>aquadoggo</code> binary is and run the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Start your aquadoggo node.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">./aquadoggo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>No binary for your system?</div><div class="admonitionContent_BuS1"><p>If there is no binary available for your system, don&#x27;t worry, you can follow the <a href="/tutorials/aquadoggo">Set up a local node</a> tutorial to learn how to compile a node yourself.</p></div></div>
<p>Now you have a local node running on port <code>2020</code>. You can check if everything is alright by opening your browser and surfing to <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a>, do you see the GraphQL playground? Super. We will play with it soon!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="download-the-application-code">Download the application code<a href="#download-the-application-code" class="hash-link" aria-label="Direct link to Download the application code" title="Direct link to Download the application code">‚Äã</a></h2>
<p>Since this is not a tutorial about how to write a React web-application, we already prepared most of the source code for you. This is how you can set it up:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Clone the `mushroom-app-tutorial` git repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">git</span><span class="token plain"> clone https://github.com/p2panda/mushroom-app-tutorial.git</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Move into the folder you&#x27;ve just created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token builtin class-name" style="color:#9ddab3">cd</span><span class="token plain"> mushroom-app-tutorial</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Install NodeJS dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s stay in the <code>mushroom-app-tutorial</code> directory from now on, we will look into some code and run a script here.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-schema">Create a schema<a href="#create-a-schema" class="hash-link" aria-label="Direct link to Create a schema" title="Direct link to Create a schema">‚Äã</a></h2>
<p>We already know what the mushroom app will be capable of, but we need to define as well how the data <em>will look like</em>. What sort of data do we want to publish, query and visualise in this application?</p>
<p>In p2panda we can create <em>schemas</em> which will help us to define the shape of the data we need. Nodes will register these schemas and start supporting them. As soon as a node supports a schema you can send that data to it and the node will give you a nice GraphQL API to query it in different ways.</p>
<p>For every p2panda application we want to build, we have to define the schemas first we want to use. It could be that there are many even, depending on how complex your program will become.</p>
<p>Usually we have to define the schemas only once, as soon as they are deployed on a real node they can be spread across the network: Other nodes will download it automatically when they think it&#x27;s a good idea to support your schema.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Nodes supporting schemas</div><div class="admonitionContent_BuS1"><p>A single node can support many schema, nodes share data based on the schema that they have in common. By default a node is happy to discover and support any schema it finds on the network, this is great for experimenting and during development, but in production you will want to limit this to only schema you want to support.</p></div></div>
<p>During development we might want to create the schema multiple times, because we&#x27;re deleting the database of our node or we&#x27;ve made some changes to the schema. That&#x27;s okay!</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>How do I delete my database?</div><div class="admonitionContent_BuS1"><p>If you&#x27;re running a node with default configurations then it is &quot;ephemeral&quot; and already no data will be persisted between runs. For other cases (using an SQLite db for example) check out the <a href="/tutorials/aquadoggo">aquadoggo Tutorial</a> to find out.</p></div></div>
<p>Enough of all of this theory! How does the data now look like for our mushroom app?</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mushroom-schema"><code>mushroom</code> Schema<a href="#mushroom-schema" class="hash-link" aria-label="Direct link to mushroom-schema" title="Direct link to mushroom-schema">‚Äã</a></h3>
<p>We want users to make <em>encyclopaedia</em> entries about all sorts of mushrooms, similar to a wiki. We keep it simple for now: The <code>mushroom</code> schema needs a <code>title</code>, a <code>description</code>, the <code>latin</code> name (because we are real mycologists) and an <code>edible</code> flag which indicates if we can eat this mushroom or if it is deadly poisonous.</p>
<ul>
<li><code>title</code>: String</li>
<li><code>description</code>: String</li>
<li><code>latin</code>: String</li>
<li><code>edible</code>: Boolean</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mushroom_finding-schema"><code>mushroom_finding</code> Schema<a href="#mushroom_finding-schema" class="hash-link" aria-label="Direct link to mushroom_finding-schema" title="Direct link to mushroom_finding-schema">‚Äã</a></h3>
<p>Next to the <code>mushroom</code> entries we need the <code>mushroom_finding</code> feed of the users. They want to upload a picture (as <code>blob</code>), define a <code>lat</code> and <code>lon</code> GPS position and mark which <code>mushrooms</code> they think it could have been. The users can select one or many mushrooms by simply just referring to the encyclopaedia entries.</p>
<p>Relating to the mushroom entries is possible with a <em>relation list</em>. This is a special sort of field where we can refer to documents of the same or even another schema, simply by mentioning their identifiers. A relation is also used in the <code>blob</code> field, where we relate to documents of type <code>blob_v1</code>, this is an in-built document type used for publishing binary data. Documents of this type are materialized to the filesystem and served from the node at an HTTP endpoint (you&#x27;ll see exactly how later).</p>
<ul>
<li><code>blob</code>: Relation with <code>blob_v1</code> documents</li>
<li><code>lat</code>: Float</li>
<li><code>lon</code>: Float</li>
<li><code>mushrooms</code>: Relation List with <code>mushroom</code> documents</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="register-schemas">Register schemas<a href="#register-schemas" class="hash-link" aria-label="Direct link to Register schemas" title="Direct link to Register schemas">‚Äã</a></h3>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>How to create a schema?</div><div class="admonitionContent_BuS1"><p>In this tutorial we are creating our schema programatically by publishing operations to the node from the front-end code. There is another tutorial showing you <a href="/tutorials/fishy">how you can create schemas</a> with the command line tool <code>fishy</code>. For this tutorial this is not necessary, but it&#x27;s a good next step if you want to learn more about schema creation, or for when you start developing your own application.</p></div></div>
<p>We could create these schemas now manually by sending operations to our node, but we already have that prepared for you. Just run the following command inside the <code>mushroom-app-tutorial</code> directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Create schemas and send them to node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> run schema</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will create the two schemas <code>mushroom</code> and <code>mushroom_finding</code> and register them on your locally running node. You can go to <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a> to check out the GraphQL playground, there you can now see the newly created schemas in the <em>Docs</em> tab on the right side!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Huh, I don&#x27;t see anything?</div><div class="admonitionContent_BuS1"><p>Oh, maybe you should refresh the page then (the playground&#x27;s auto-refresh can be turned on / off).</p></div></div>
<p>You can see that the script gave us some instructions on what to do next:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">Next step: Create a file `./schemas.json` and paste this into it:</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  &quot;MUSHROOM_SCHEMA_ID&quot;: &quot;mushroom_0020c3accb0b0c8822ecc0309190e23de5f7f6c82f660ce08023a1d74e055a3d7c4d&quot;,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  &quot;FINDINGS_SCHEMA_ID&quot;: &quot;mushroom_finding_0020aaabb3edecb2e8b491b0c0cb6d7d175e4db0e9da6003b93de354feb9c52891d0&quot;</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Your schema ids will look a little bit different since every generated schema is unique! Let&#x27;s do what the program says and create a <code>schemas.json</code> file where we copy this JSON inside. This will tell the program what schemas to look for when doing the GraphQL queries.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="build-the-application">Build the application<a href="#build-the-application" class="hash-link" aria-label="Direct link to Build the application" title="Direct link to Build the application">‚Äã</a></h2>
<p>Designing and creating a schema is a very large part of building an p2panda application. The other part is implementing the interface! Suddenly we&#x27;re back at <em>normal</em> web development: Spending long time figuring out how to set up TypeScript, Webpack, some linters like eslint and prettier etc., building React components and views integrating a router and so on. If you are a web developer then this part will be very familiar to you, so let&#x27;s focus rather on the parts which make it a <em>special</em> p2panda application.</p>
<p>To build something with p2panda in TypeScript or JavaScript we can use the package <a href="https://www.npmjs.com/package/shirokuma" target="_blank" rel="noopener noreferrer"><code>shirokuma</code></a>. With it we can do the most important things: 1. Initialise the WebAssembly code 2. Generate a key pair 3. Create and send p2panda operations to a node. We query documents back from the node using a lightweight GraphQL client.</p>
<p>Let&#x27;s go through them step by step!</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="initialise-webassembly">Initialise WebAssembly<a href="#initialise-webassembly" class="hash-link" aria-label="Direct link to Initialise WebAssembly" title="Direct link to Initialise WebAssembly">‚Äã</a></h3>
<p><code>shirokuma</code> uses <code>p2panda-js</code> under the hood, and this is actually mainly developed in Rust and compiled as WebAssembly with a thin TypeScript wrapper around it to make it <em>feel</em> more like a regular TypeScript package. Using WebAssembly is a little bit special and requires you to initialise it before you can use it.</p>
<p>In <code>shirokuma</code> we can simply do this like that:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> initWebAssembly </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">initWebAssembly</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Where is the WebAssembly code?</div><div class="admonitionContent_BuS1"><p>Good question! We are encoding the WebAssembly code as a base64 string <em>inside</em> the JavaScript files. This is why it just works like that. If you want to manually load the <code>.wasm</code> file we have you covered as well, just check out the <a href="https://github.com/p2panda/p2panda/blob/main/p2panda-js/README.md" target="_blank" rel="noopener noreferrer"><code>README.md</code></a> of the package.</p></div></div>
<p>You might already see the problem here though: The <code>initWebAssembly</code> function is async! This means that we have to <em>wait</em> until we can do anything else, like generating a key pair for the user or sending our first operation to the node.</p>
<p>Luckily React can help us with some convenient patterns, let&#x27;s look at the <a href="https://github.com/p2panda/mushroom-app-tutorial/blob/main/src/components/InitWasm.tsx" target="_blank" rel="noopener noreferrer"><code>src/components/InitWasm.tsx</code></a> file to see how we did it in the mushroom app:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> useEffect</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;react&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> initWebAssembly </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">type</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Props</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  children</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">JSX</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">Element</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">export</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> InitWasm</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token constant" style="color:#6699cc">FC</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">Props</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> children </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token plain">ready</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> setReady</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">useState</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token function" style="color:#66cccc;font-weight:bold">useEffect</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#66cccc;font-weight:bold">init</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">initWebAssembly</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token function" style="color:#66cccc;font-weight:bold">setReady</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token function" style="color:#66cccc;font-weight:bold">init</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> ready </span><span class="token operator" style="color:#f2f0ec">?</span><span class="token plain"> children </span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>InitWasm</code> component will load all <code>children</code> components as soon as everything got initialised. If you are concerned about loading times (it should be less than a couple of milliseconds) then you can even add a small spinner here.</p>
<p>We wrap the whole application component <code>App</code> around <code>InitWasm</code> and make sure nothing gets executed before we are ready:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> Root</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function-variable function" style="color:#66cccc;font-weight:bold">FC</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">InitWasm</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">App </span><span class="token operator" style="color:#f2f0ec">/</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token operator" style="color:#f2f0ec">/</span><span class="token plain">InitWasm</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="generate-key-pair">Generate key pair<a href="#generate-key-pair" class="hash-link" aria-label="Direct link to Generate key pair" title="Direct link to Generate key pair">‚Äã</a></h3>
<p>Right after we initialised the WebAssembly we want to make sure that the user gets a key pair. This is required to give the user some sort of identity but also to sign the data the user want&#x27;s to create.</p>
<p>It is quite easy to generate a new key pair with <code>shirokuma</code>:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> KeyPair </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> keyPair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>But we do not always want to generate a <em>new</em> key pair every time the user comes back to the website! We should persist the private key using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer"><code>Window.LocalStorage</code></a> API:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> KeyPair </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">LOCAL_STORAGE_KEY</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;privateKey&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">function</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">getKeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> KeyPair </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token comment" style="color:#66cccc">// Check if a private key already exists and derive key pair from it if yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> privateKey </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">getItem</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token constant" style="color:#6699cc">LOCAL_STORAGE_KEY</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">privateKey</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">privateKey</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token comment" style="color:#66cccc">// Generate a new key pair otherwise and persist it in localStorage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> keyPair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  window</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setItem</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token constant" style="color:#6699cc">LOCAL_STORAGE_KEY</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> keyPair</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">privateKey</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> keyPair</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we can just call <code>getKeyPair</code> and we will either receive a new key pair when doing it for the first time or the old one if we&#x27;re coming back.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="session">Session<a href="#session" class="hash-link" aria-label="Direct link to Session" title="Direct link to Session">‚Äã</a></h3>
<p><code>shirokuma</code> exports the <code>Session</code> object which offers us a useful interface for publishing operations to a node. It can be configured with an endpoint, key pair, and schema id. It can be useful to instantiate it at the beginning of your application and keep it around for making queries later. Starting a <code>Session</code> looks like this:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> KeyPair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> Session </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">ENDPOINT</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;localhost:2020/graphql&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> keyPair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> session </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Session</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token constant" style="color:#6699cc">ENDPOINT</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setKeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">keyPair</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>But how do we now share this information across the whole React application? As a React developer you might know some patterns probably: Prop drilling, Redux, Contexts .. there are many options and it is basically up to you! In the mushroom app we&#x27;ve decided to use the <a href="https://reactjs.org/docs/context.html" target="_blank" rel="noopener noreferrer">Context</a> pattern which gets especially interesting if we have many components. Let&#x27;s have a look at the <a href="https://github.com/p2panda/mushroom-app-tutorial/blob/main/src/P2pandaContext.tsx" target="_blank" rel="noopener noreferrer"><code>src/P2pandaContext.tsx</code></a> file:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> useMemo </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;react&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> KeyPair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> Session </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">ENDPOINT</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;./constants&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">LOCAL_STORAGE_KEY</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;privateKey&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">function</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">getKeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> KeyPair </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token comment" style="color:#66cccc">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">type</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Context</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  publicKey</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  keyPair</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> KeyPair </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  session</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> Session </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">export</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> P2pandaContext </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token generic-function function" style="color:#66cccc;font-weight:bold">createContext</span><span class="token generic-function generic class-name operator" style="color:#f2f0ec">&lt;</span><span class="token generic-function generic class-name" style="color:#9ddab3">Context</span><span class="token generic-function generic class-name operator" style="color:#f2f0ec">&gt;</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  publicKey</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  keyPair</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  session</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">null</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">type</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Props</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  children</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">JSX</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">Element</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">export</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> P2pandaProvider</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token constant" style="color:#6699cc">FC</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">Props</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> children </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> state </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">useMemo</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> keyPair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">getKeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> session </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Session</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token constant" style="color:#6699cc">ENDPOINT</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setKeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">keyPair</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      keyPair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      publicKey</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> keyPair</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">publicKey</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      session</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">P2pandaContext</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">Provider value</span><span class="token operator" style="color:#f2f0ec">=</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">state</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">children</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token operator" style="color:#f2f0ec">/</span><span class="token plain">P2pandaContext</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">Provider</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>P2pandaProvider</code> helps us to establish the state of the <code>P2pandaContext</code> by calling <code>getKeyPair</code> and instantiating a <code>Session</code>. From that point on we can consume this app state by using <code>P2pandaContext.Consumer</code> in other components like that:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">P2pandaContext</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">Consumer</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> publicKey </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain">Hello</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token operator" style="color:#f2f0ec">!</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token operator" style="color:#f2f0ec">/</span><span class="token plain">p</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token operator" style="color:#f2f0ec">/</span><span class="token plain">P2pandaContext</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">Consumer</span><span class="token operator" style="color:#f2f0ec">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you need the <code>keyPair</code> already before, you can import the <code>useContext</code> hook and access all values like that:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> useContext </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;react&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> keyPair </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">useContext</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">P2pandaContext</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Really handy!</p>
<p>We have to make sure to establish the <code>P2pandaProvider</code> in the application as well, we&#x27;re doing this right at the beginning, next to <code>InitWasm</code>:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> Root</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function-variable function" style="color:#66cccc;font-weight:bold">FC</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">InitWasm</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">P2pandaProvider</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">App </span><span class="token operator" style="color:#f2f0ec">/</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token operator" style="color:#f2f0ec">/</span><span class="token plain">P2pandaProvider</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    </span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token operator" style="color:#f2f0ec">/</span><span class="token plain">InitWasm</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="publish-operations">Publish operations<a href="#publish-operations" class="hash-link" aria-label="Direct link to Publish operations" title="Direct link to Publish operations">‚Äã</a></h3>
<p>Operations are the building blocks of p2panda, they are the instructions we publish to a node in order to CREATE, UPDATE and DELETE documents.</p>
<p><code>Session</code> offers us a long running interface for publishing operations to a node, setting it up and creating a document looks like this:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> KeyPair</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> Session </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;shirokuma&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> keyPair </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">KeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> session </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Session</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&#x27;localhost:2020/graphql&#x27;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">setKeyPair</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">keyPair</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> fields </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  title</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;Mario Mushroom&#x27;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  latin</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;Marius Fungus&#x27;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  edible</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  description</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;It makes you grow&#x27;</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> documentId </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"> session</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">create</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">fields</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  schemaId</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token constant" style="color:#6699cc">MUSHROOM_SCHEMA_ID</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Yes! We&#x27;re creating our first <code>mushroom</code> document here!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Playing in NodeJS</div><div class="admonitionContent_BuS1"><p><code>shirokuma</code> also runs in NodeJS and there you don&#x27;t even need to initialise the WebAssembly! It is fun to play with the API in the interactive NodeJS environment. Just type <code>node</code> inside the the <code>mushroom-app-tutorial</code> folder, type <code>const shirokuma = require(&#x27;shirokuma&#x27;)</code>, hit <code>Enter</code>, and then you can directly get started, for example by writing <code>const keyPair = new shirokuma.KeyPair()</code>!</p></div></div>
<p>In the example above we are already using the schema id we&#x27;ve created before. Usually you want to keep the schema id in some central place, like in <a href="https://github.com/p2panda/mushroom-app-tutorial/blob/main/src/constants.ts" target="_blank" rel="noopener noreferrer"><code>src/constants.ts</code></a>. Especially after you officially released your p2panda application it will stay hard-coded like that since schema ids <em>never</em> change, except of when you migrate to a new schema version of course (but then you also very likely will update your application).</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Schema migrations</div><div class="admonitionContent_BuS1"><p>Updating a schema after releasing an application will not break it! Schema ids are <em>immutable</em> identifiers of the schema for exactly <em>that</em> version of it. If you introduce a new version, old applications will still point at the previous schema id and the new ones can already support the latest schema.</p><p>In the future we want to offer <a href="https://www.inkandswitch.com/cambria/" target="_blank" rel="noopener noreferrer">Lenses</a> to automatically support old and new schemas, especially in a p2p system this gets very important after a while.</p></div></div>
<p>If we&#x27;re updating or deleting a document we need to specify <em>what</em> document we want to apply these changes on. This we do by passing in the <code>viewId</code>. The <code>viewId</code> you can get from the GraphQL API, whenever you query for the documents you want to update or delete.</p>
<p>All of this you find in the <a href="https://github.com/p2panda/mushroom-app-tutorial/blob/main/src/requests.ts" target="_blank" rel="noopener noreferrer"><code>src/requests.ts</code></a> file, there you will find other queries as well, for example to create <code>mushroom_finding</code> documents.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="query-documents">Query documents<a href="#query-documents" class="hash-link" aria-label="Direct link to Query documents" title="Direct link to Query documents">‚Äã</a></h3>
<p>You can use any GraphQL client to query documents back from the node, let&#x27;s set ours up quickly like this:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> GraphQLClient</span><span class="token punctuation" style="color:#f2f0ec">,</span><span class="token plain"> gql </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">from</span><span class="token plain"> </span><span class="token string" style="color:#cc99cc">&#x27;graphql-request&#x27;</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> client </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">new</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">GraphQLClient</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token string" style="color:#cc99cc">&#x27;http://localhost:2020/graphql&#x27;</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>GraphQL libraries</div><div class="admonitionContent_BuS1"><p>In this tutorial we&#x27;re using <a href="https://www.npmjs.com/package/graphql-request" target="_blank" rel="noopener noreferrer"><code>graphql-request</code></a> as a GraphQL client. We like this one because it is very simple and lightweight, but there are many others as well, for example <a href="https://www.apollographql.com/" target="_blank" rel="noopener noreferrer">Apollo</a>.</p></div></div>
<p>After creating the <code>mushroom</code> documents we want to query them as well. We can do this like that:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">type</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Meta</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  viewId</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  documentId</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">type</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">Mushroom</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  description</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  edible</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">boolean</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  latin</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  title</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">type</span><span class="token plain"> </span><span class="token class-name" style="color:#9ddab3">MushroomResponse</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  meta</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> Meta</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  fields</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> Mushroom</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">function</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">getAllMushrooms</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">Promise</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">MushroomResponse</span><span class="token punctuation" style="color:#f2f0ec">[</span><span class="token punctuation" style="color:#f2f0ec">]</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> query </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string" style="color:#cc99cc">`</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql attr-name" style="color:#f2f0ec">mushrooms</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql object">all_</span><span class="token template-string graphql language-graphql object interpolation interpolation-punctuation punctuation" style="color:#f2f0ec">${</span><span class="token template-string graphql language-graphql object interpolation constant" style="color:#6699cc">MUSHROOM_SCHEMA_ID</span><span class="token template-string graphql language-graphql object interpolation interpolation-punctuation punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql object">documents</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql object">meta</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql property">documentId</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql property">viewId</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql object">fields</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql property">description</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql property">edible</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql property">latin</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql property">title</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string template-punctuation string" style="color:#cc99cc">`</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> mushrooms </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">request</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">query</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> mushrooms</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token plain">documents</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you prepend the schema id in the query with <code>all_</code> you receive a collection of <em>all</em> <code>mushroom</code> documents.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Pagination, filters and sorting</div><div class="admonitionContent_BuS1"><p>The <a href="https://p2panda.org/specification/APIs/queries" target="_blank" rel="noopener noreferrer">specification</a> already mentions pagination, filters and sorting but we have not implemented it yet, it will come soon!</p></div></div>
<p>See how we can also get some <code>meta</code> fields from the regarding mushroom documents? We can get the <code>documentId</code> and <code>viewId</code> for each entry, this helps us to update or delete the data as mentioned earlier.</p>
<p>If you want to only load one mushroom you can write something like this:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token keyword" style="color:#ffcc66">async</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">function</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">getMushroom</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">documentId</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">string</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token operator" style="color:#f2f0ec">:</span><span class="token plain"> </span><span class="token builtin" style="color:#6699cc">Promise</span><span class="token operator" style="color:#f2f0ec">&lt;</span><span class="token plain">MushroomResponse</span><span class="token operator" style="color:#f2f0ec">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> query </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string" style="color:#cc99cc">`</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql attr-name" style="color:#f2f0ec">mushroom</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name interpolation interpolation-punctuation punctuation" style="color:#f2f0ec">${</span><span class="token template-string graphql language-graphql class-name interpolation constant" style="color:#6699cc">MUSHROOM_SCHEMA_ID</span><span class="token template-string graphql language-graphql class-name interpolation interpolation-punctuation punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#f2f0ec">id</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#cc99cc">&quot;</span><span class="token template-string graphql language-graphql string interpolation interpolation-punctuation punctuation" style="color:#f2f0ec">${</span><span class="token template-string graphql language-graphql string interpolation" style="color:#cc99cc">documentId</span><span class="token template-string graphql language-graphql string interpolation interpolation-punctuation punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql string" style="color:#cc99cc">&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql object">meta</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property">documentId</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property">viewId</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql object">fields</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property">description</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property">edible</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property">latin</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property">title</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style="color:#f2f0ec">}</span><span class="token template-string template-punctuation string" style="color:#cc99cc">`</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#f2f0ec">{</span><span class="token plain"> mushroom </span><span class="token punctuation" style="color:#f2f0ec">}</span><span class="token plain"> </span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc66">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#f2f0ec">.</span><span class="token function" style="color:#66cccc;font-weight:bold">request</span><span class="token punctuation" style="color:#f2f0ec">(</span><span class="token plain">query</span><span class="token punctuation" style="color:#f2f0ec">)</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc66">return</span><span class="token plain"> mushroom</span><span class="token punctuation" style="color:#f2f0ec">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token punctuation" style="color:#f2f0ec">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we talked almost about everything you need to build an p2panda application with React. You can dive a little bit more inside of the source code to see some details, but we should have covered the most important parts concerning p2panda!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="run-the-application">Run the application<a href="#run-the-application" class="hash-link" aria-label="Direct link to Run the application" title="Direct link to Run the application">‚Äã</a></h2>
<p>Finally, let&#x27;s use the mushroom app now!</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">npm</span><span class="token plain"> start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will run the web application under <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080</a>. You can open it in your browser and start playing with it. If you&#x27;re curious you can also check the GraphQL playground of the <code>aquadoggo</code> and make some queries there to compare!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-do-i-need" class="table-of-contents__link toc-highlight">What do I need?</a></li><li><a href="#start-node" class="table-of-contents__link toc-highlight">Start node</a></li><li><a href="#download-the-application-code" class="table-of-contents__link toc-highlight">Download the application code</a></li><li><a href="#create-a-schema" class="table-of-contents__link toc-highlight">Create a schema</a><ul><li><a href="#mushroom-schema" class="table-of-contents__link toc-highlight"><code>mushroom</code> Schema</a></li><li><a href="#mushroom_finding-schema" class="table-of-contents__link toc-highlight"><code>mushroom_finding</code> Schema</a></li><li><a href="#register-schemas" class="table-of-contents__link toc-highlight">Register schemas</a></li></ul></li><li><a href="#build-the-application" class="table-of-contents__link toc-highlight">Build the application</a><ul><li><a href="#initialise-webassembly" class="table-of-contents__link toc-highlight">Initialise WebAssembly</a></li><li><a href="#generate-key-pair" class="table-of-contents__link toc-highlight">Generate key pair</a></li><li><a href="#session" class="table-of-contents__link toc-highlight">Session</a></li><li><a href="#publish-operations" class="table-of-contents__link toc-highlight">Publish operations</a></li><li><a href="#query-documents" class="table-of-contents__link toc-highlight">Query documents</a></li></ul></li><li><a href="#run-the-application" class="table-of-contents__link toc-highlight">Run the application</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_J6tW"><img class="footer-img__0Xc" src="/images/deepsea-panda.svg" width="100"><div><img class="supporters-img_P2oV" src="/images/nlnet-logo.svg" width="140"><img class="supporters-img_P2oV" src="/images/ngi-logo.png" width="200"><img class="supporters-img_P2oV" src="/images/eu-flag-logo.png" width="78"><p class="footer-text_MXRq">This project has received funding from the European Union‚Äôs Horizon 2020 research and innovation programme within the framework of the NGI-POINTER Project funded under grant agreement No 871528, NGI-ASSURE No 957073 and NGI0-ENTRUST No 101069594</p></div><p class="footer-text_MXRq">CC BY-SA 4.0<!-- --> - <a href="/contact">Contact</a> -<!-- --> <a href="https://autonomous.zone/@p2panda" target="_blank" rel="noreferrer">Fediverse</a></p></footer></div>
</body>
</html>