<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/send-to-node" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Tutorial: Create a schema | p2panda</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://p2panda.org/tutorials/send-to-node"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tutorial: Create a schema | p2panda"><meta data-rh="true" name="description" content="In this tutorial we want to register a new schema on a p2panda node and create our first document with it! We will use the send-to-node command line tool and aquadoggo node for this."><meta data-rh="true" property="og:description" content="In this tutorial we want to register a new schema on a p2panda node and create our first document with it! We will use the send-to-node command line tool and aquadoggo node for this."><link data-rh="true" rel="icon" href="/images/deepsea-panda.svg"><link data-rh="true" rel="canonical" href="https://p2panda.org/tutorials/send-to-node"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/send-to-node" hreflang="en"><link data-rh="true" rel="alternate" href="https://p2panda.org/tutorials/send-to-node" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="p2panda News RSS Feed"><link rel="stylesheet" href="/assets/css/styles.862b1275.css">
<script src="/assets/js/runtime~main.ef19c589.js" defer="defer"></script>
<script src="/assets/js/main.97848bd4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="navbar__brand"><div class="navbar__logo"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></div></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/learn/">Learn</a><a class="navbar__item navbar__link" href="/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/sdks/">SDKs</a><a class="navbar__item navbar__link" href="/specifications/">Specifications</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/links">Links</a><a class="navbar__item navbar__link" href="/contact">Contact</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tutorial: Create a schema</h1></header><p>In this tutorial we want to register a new schema on a p2panda node and create our first document with it! We will use the <a href="https://github.com/p2panda/send-to-node" target="_blank" rel="noopener noreferrer"><code>send-to-node</code></a> command line tool and <a href="https://github.com/p2panda/aquadoggo" target="_blank" rel="noopener noreferrer"><code>aquadoggo</code></a> node for this.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-do-i-need">What do I need?<a href="#what-do-i-need" class="hash-link" aria-label="Direct link to What do I need?" title="Direct link to What do I need?">‚Äã</a></h2>
<ul>
<li>Rust</li>
<li>Editor</li>
<li>Terminal</li>
<li>Browser</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Never worked with Rust before?</div><div class="admonitionContent_BuS1"><p>This tutorial requires you to have a working Rust environment. If you have never worked with Rust before this is no problem! Setting it up is fairly easy and besides using some basic command line commands there is no more Rust knowledge required to make the node run on your computer.</p></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q"><p></p><summary>How do I install Rust?</summary>
Make sure you have a working Rust environment installed on your computer before you begin with the tutorial. You can check this by running <code>rustc --version</code> in your terminal. This tutorial was written with Rust version <code>1.63.0</code> but it will probably also work with other versions.<p></p><p>If you don&#x27;t have Rust installed yet you can follow the steps on the official Rust website: <a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noopener noreferrer">How to install Rust</a>.</p></div></div></details>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-is-send-to-node">What is <code>send-to-node</code>?<a href="#what-is-send-to-node" class="hash-link" aria-label="Direct link to what-is-send-to-node" title="Direct link to what-is-send-to-node">‚Äã</a></h2>
<p><code>send-to-node</code> is the most minimal program to send data to an p2panda node. It takes the data you want to send, signs it with a private key and sends it to the node via GraphQL. It is great for doing very <em>basic</em> things with p2panda, especially if you want to learn how everything works!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>More tools</div><div class="admonitionContent_BuS1"><p>In the future you will probably not do <em>everything</em> with <code>send-to-node</code> as it is may be even too minimal and therefore tedious to do more involved tasks, like creating complex schemas. But for learning, testing and understanding it is really great.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-does-it-work">How does it work?<a href="#how-does-it-work" class="hash-link" aria-label="Direct link to How does it work?" title="Direct link to How does it work?">‚Äã</a></h3>
<p>Let&#x27;s have a quick look at the <a href="https://github.com/p2panda/send-to-node/blob/main/src/main.rs" target="_blank" rel="noopener noreferrer">source code of <code>send-to-node</code></a>. You will notice that it is a fairly small program where most of the code is about parsing user input and preparing everything we need to make GraphQL queries.</p>
<p>Let&#x27;s look at the interesting bits! The program ..</p>
<ol>
<li>Checks if a file with a private key inside exists (encoded as a hexadecimal string). The default path is <code>key.txt</code>. If it exists, we derive the key pair from it, if it doesn&#x27;t, we generate a new key pair and store it under that path.</li>
<li>Reads a JSON-formatted string from <em>stdin</em> which gets deserialized into a p2panda operation. Operations are the actual data we send around in the network.</li>
<li>Makes a <code>nextArgs</code> GraphQL query to retreive the latest information from the node we need to create our next entry. You can <a href="/learn/entries">read more about entries</a> in our learn section.</li>
<li>Takes the required informations (like <code>seqNum</code>, <code>logId</code>, <code>backlink</code> and <code>skiplink</code>) to encode the operation and entry</li>
<li>Signs the entry with the given key pair</li>
<li>Sends the encoded and signed data to the node using the <code>publish</code> GraphQL mutation!</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Re-Write it in JavaScript!</div><div class="admonitionContent_BuS1"><p>A fun exercise could be to try implement <code>send-to-node</code> in JavaScript with the <a href="https://www.npmjs.com/package/p2panda-js" target="_blank" rel="noopener noreferrer"><code>p2panda-js</code></a> package.</p></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Why JSON?</div><div class="admonitionContent_BuS1"><p>p2panda does not use JSON internally, even though <code>send-to-node</code> works with <code>.json</code> files. It is just the choosen format for this program to create operations. Internally all operations are actually encoded as <a href="/specifications/aquadoggo/data-types/operations">CBOR</a>.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="install-send-to-node">Install <code>send-to-node</code><a href="#install-send-to-node" class="hash-link" aria-label="Direct link to install-send-to-node" title="Direct link to install-send-to-node">‚Äã</a></h3>
<p>Run the following commands in your terminal if you haven&#x27;t installed <code>send-to-node</code> yet. It is a Rust program you can compile on your computer:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Clone the `send-to-node` git repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">git</span><span class="token plain"> clone https://github.com/p2panda/send-to-node.git</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Move into the folder you&#x27;ve just created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token builtin class-name" style="color:#9ddab3">cd</span><span class="token plain"> send-to-node</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Compile and run to test it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run -- </span><span class="token parameter variable" style="color:#f2f0ec">--help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Compiling <code>send-to-node</code> might take a couple of seconds in the beginning, but next time it will start directly.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="start-node">Start node<a href="#start-node" class="hash-link" aria-label="Direct link to Start node" title="Direct link to Start node">‚Äã</a></h2>
<p>We want to send data to a node, but for this we need a node first! You can follow the <a href="/tutorials/aquadoggo">Set up a local node</a> to learn how to do this in detail, or just run the following steps here:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token comment" style="color:#66cccc"># Clone the `aquadoggo` git repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token function" style="color:#66cccc;font-weight:bold">git</span><span class="token plain"> clone https://github.com/p2panda/aquadoggo.git</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Move into the folder you&#x27;ve just created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token builtin class-name" style="color:#9ddab3">cd</span><span class="token plain"> aquadoggo</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token comment" style="color:#66cccc"># Compile and start the node with basic logging enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain"></span><span class="token assign-left variable" style="color:#f2f0ec">RUST_LOG</span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain">aquadoggo</span><span class="token operator" style="color:#f2f0ec">=</span><span class="token plain">info </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now you have a local node running on port <code>2020</code>. You can check if everything is alright by opening your browser and surfing to <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a>, do you see the GraphQL playground? Super. Let&#x27;s play with it soon!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-schema">Create a schema<a href="#create-a-schema" class="hash-link" aria-label="Direct link to Create a schema" title="Direct link to Create a schema">‚Äã</a></h2>
<p>We want to register a new schema on the node now, this means that the node we&#x27;ve just started will learn about a new data type which can then be used inside the p2panda network. This is the starting point for building an application!</p>
<p>But what application do we want to build? Let&#x27;s try a chat where we can send messages! Every message should contain a <strong>plain text string</strong> and a <strong>timestamp</strong> indicating when it was sent.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Time is funny</div><div class="admonitionContent_BuS1"><p>Timestamps in p2p applications are interesting. Check out the <a href="/learn/entries">Entry</a> section to learn more about it.</p></div></div>
<p>To do this we need to send three operations:</p>
<ol>
<li>One operation creating the <code>message</code> field</li>
<li>One operation creating the <code>timestamp</code> field</li>
<li>One operation to finally create the <code>chat</code> schema which contains both of these fields</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Schemas are only created once</div><div class="admonitionContent_BuS1"><p>Creating a schema only happens once! Afterwards you and others can just use it, they do not need to &quot;register&quot; it again or anything, but other nodes can simply just replicate the data from your node to also receive the schema you&#x27;ve created.</p></div></div>
<p>All the next steps will take place inside the <code>send-to-node</code> directory you downloaded via git. Make sure you are in that folder in your terminal!</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-message-field">Create <code>message</code> field<a href="#create-message-field" class="hash-link" aria-label="Direct link to create-message-field" title="Direct link to create-message-field">‚Äã</a></h3>
<p>As already mentioned, <code>send-to-node</code> requires us to format the data we want to send in JSON. In a text editor of your choice we can write our first operation into a file named <code>001-message-field.json</code>:</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Naming</div><div class="admonitionContent_BuS1"><p>The filename does not matter to <code>send-to-node</code>, but it can be helpful to give it a meaningful name for you plus some sort of numbering system to indicate that these operations should be created in that order.</p></div></div>
<p>Insert the following content into the <code>001-message-field.json</code> file:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[1, 0, &quot;schema_field_definition_v1&quot;, { &quot;name&quot;: &quot;message&quot;, &quot;type&quot;: &quot;str&quot; }]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-is-an-operation">What is an operation?<a href="#what-is-an-operation" class="hash-link" aria-label="Direct link to What is an operation?" title="Direct link to What is an operation?">‚Äã</a></h4>
<p>What does all of this mean? We look at an array with four fields inside. Let&#x27;s go through all of them from left to right.</p>
<p><strong>Version</strong></p>
<p>The first field with the value <code>1</code> indicates the version we&#x27;re using to write this operation. For now it will probably stay <code>1</code> for a longer time until there are any important updates to the p2panda <a href="/specifications">specification</a>.</p>
<p><strong>Action</strong></p>
<p>The second field with the value <code>0</code> indicates the <em>action</em> of this operation. <code>0</code> stands for CREATE, <code>1</code> would stand for UPDATE and <code>2</code> for DELETE. You can read more about operations in the <a href="/learn/operations">learn</a> section or the <a href="/specifications/aquadoggo/data-types/operations">specification</a> but for now it is enough to understand that with these three actions we can create, update or delete <em>documents</em>.</p>
<p>In this particular case we&#x27;re creating a new <em>schema field</em> document, the one containing the <code>message</code> field! This is why the action is set to <code>0</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Why these numbers?</div><div class="admonitionContent_BuS1"><p>We could have also written <code>create</code>, <code>update</code>, <code>delete</code> instead of these weird numbers, but then we realised that at one point you will send hundreds of operations, so it becomes quite redundant to mention this so explicitly. We decided to encode actions as numbers, simply to save some bytes!</p></div></div>
<p><strong>Schema Id</strong></p>
<p>The third field with the value <code>schema_field_definition_v1</code> is the <em>schema id</em>. This identifier indicates which schema we&#x27;re following with this operation. Together with the <em>action</em> we can say now: &quot;I&#x27;m creating a new schema field document!&quot;. We know this because the <em>action</em> is a CREATE action and the schema id says that we&#x27;re interested in a schema field.</p>
<p>You will see later that there are other schema ids as well, and by creating a <code>chat</code> schema we will even create our own! Other developers will later use your created schema id to indicate that they want to create documents with it!</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>System vs. application schemas</div><div class="admonitionContent_BuS1"><p><code>schema_field_definition_v1</code> is a <em>system</em> schema which means that it is already registered by default on every node which follows the <a href="/specifications/aquadoggo/data-types/schemas">p2panda specification</a>. Our <code>chat</code> schema will be an <em>application</em> schema, it is not used for special p2panda cases like creating a new schema but for building a chat application!</p></div></div>
<p><strong>Fields</strong></p>
<p>The last and fourth field is probably the most interesting one, it contains the actual data we want to send: The operation <em>fields</em> with all our <em>values</em>! You see, it is a simple key-value map where we&#x27;re setting two fields:</p>
<ul>
<li><code>name</code> is set to <code>message</code></li>
<li><code>type</code> is set to <code>str</code></li>
</ul>
<p>First of all, where does <code>name</code> and <code>type</code> come from? It comes from the defined <em>schema id</em> <code>schema_field_definition_v1</code> which is a system schema <em>requiring</em> us to fill out these fields by specification: Every schema field <em>needs</em> a <code>name</code> and a <code>type</code>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Try to break it!</div><div class="admonitionContent_BuS1"><p>You can try to send a <code>schema_field_definition_v1</code> with missing or wrong fields inside, you will see, it will not be accepted by the <code>aquadoggo</code> node.</p></div></div>
<p>The <code>name</code> field indicates what the name of our future schema field should be and we decided it should be <code>message</code>. You can put in anything else here if you want to come up with a different schema, just make sure it follows the <a href="/specifications/aquadoggo/data-types/schemas">naming rules</a>.</p>
<p>The <code>type</code> field indicates what type this <code>message</code> field should have. We can pick a couple of options here, but <code>str</code> is probably what we want. Otherwise there is:</p>
<ul>
<li><code>int</code>, which is an integer number (<code>i64</code>), like <code>54</code> or <code>-21</code> ranging from <code>-9223372036854775808</code> to <code>9223372036854775807</code>, hui!</li>
<li><code>float</code>, which is a float number (<code>f64</code>), like <code>23.98</code> ranging from <code>-1.7976931348623157E+308f64</code> to <code>1.7976931348623157E+308f64</code>, oha!</li>
<li><code>bool</code>, which can be <code>true</code> or <code>false</code></li>
<li><code>str</code>, which can be any sort of text, for example a chat message!</li>
</ul>
<p>.. and now it gets interesting, there is even more:</p>
<ul>
<li><code>relation</code>, which can be a reference to another document! Woah.</li>
<li><code>relation_list</code>, which can be a list of references to many documents!</li>
<li><code>pinned_relation</code>, which can be a reference to a <em>document view</em>. This is a document in a past, historical version. Like an <em>archived</em> version you wanted to keep. So cool.</li>
<li><code>pinned_relation_list</code>, which is a list of document views! ü§Ø</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Why do we need relations?</div><div class="admonitionContent_BuS1"><p>Relations are really handy if you want to connect one document to another, even across different schemas. For example you might want to connect every <code>chat</code> message to a user <code>profile</code> document, then you would first create a new <code>profile</code> schema, and indicate in <code>chat</code> that there is now a <code>relation</code> to it!</p></div></div>
<p>We will not use any relations in this tutorial, but if you&#x27;re curious you can read more about them in the <a href="/learn/operations">learn section</a>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="send-to-node">Send to node<a href="#send-to-node" class="hash-link" aria-label="Direct link to Send to node" title="Direct link to Send to node">‚Äã</a></h4>
<p>Okay, we looked now at what this whole operation is about! Let&#x27;s send it finally to the node! Make sure it is all up and running.</p>
<p>We send the operation with <code>send-to-node</code> by simply <em>piping</em> it into the <code>stdin</code> input of the program, like that:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">cat</span><span class="token plain"> 001-message-field.json </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As already mentioned above, this will now encode the operation into the right format, wrap it into a <a href="/learn/entries">Bamboo entry</a>, append it to the Bamboo log, sign it with your new key pair and send it to the node.</p>
<p>If everything went fine we should see something similar like this now:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚ñ∂ Public Key: &quot;b129339f1264614a7c6b62cc20f9bfa21a0763a5198db82d85ae9c8543578f10&quot;</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">‚ñ∂ Operation Id: &quot;0020f7be169cacc814b21526e018ad3cb423c93b215b5bd4901146b6bed1b1c4560e&quot;</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">Woho! „ÉΩ(Ôø£(ÔΩ¥)Ôø£)Ôæâ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>First we see the <em>Public Key</em> of our key pair. It will be different for you since these keys are securely and randomly generated. Your key will be unique! You can probably find the private part in the file now which has been generated for you by <code>send-to-node</code> when running it for the first time, have a look at it via <code>less ./key.txt</code>.</p>
<p>The second <em>Operation Id</em> is the identifier of the operation we&#x27;ve just created! In this case it was even a CREATE operation which means that we&#x27;ve just created a new document and that means that the document id will be the same. So now we could say: &quot;I&#x27;ve created a <code>message</code> field and its document id is <code>0020f7be169...</code>&quot;. This hash of course will also be different from mine since it is all a combination of your key pair, created entry and operation and this is also <em>unique</em>.</p>
<p>This also means that <em>every</em> operation, document and schema you create <em>is</em> unique! Even when you would create the field again, it will have a different identifier.</p>
<p>Let&#x27;s remember this operation id for now, we need it later. Ah, of course its too long to remember, maybe you paste it quickly into a text document or something?</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêº</span></span>Sensitive data</div><div class="admonitionContent_BuS1"><p>Private keys are sensitive information which should never leave your computer, usually you want to keep them somewhere in a well protected place. For this tutorial it may not be that important though, you could delete that file again and generate a new one if you want. If you keep the file <code>send-to-node</code> will re-use it next time which is cool.</p><p>By the way, in p2panda it is important to have <a href="/specifications/aquadoggo/data-types/key-pairs">multiple keys</a> for different applications, purposes or devices.</p></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="query-the-field">Query the field<a href="#query-the-field" class="hash-link" aria-label="Direct link to Query the field" title="Direct link to Query the field">‚Äã</a></h4>
<p>We&#x27;ve created a new field now, so we can also directly inspect it via the GraphQL playground of the <code>aquadoggo</code> node. For this you can just surf to <a href="http://localhost:2020/graphql" target="_blank" rel="noopener noreferrer">http://localhost:2020/graphql</a> and run the following query in the left area:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  all_schema_field_definition_v1 {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    documents {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      meta {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        documentId</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      fields {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        name</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        type</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Press the <em>Play</em> button in the middle and you will see the node&#x27;s response appear in the right area. Here is the field document we&#x27;ve just created! And if you compare your <em>Operation Id</em> with the <code>documentId</code> you will see that they are the same.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-timestamp-field">Create <code>timestamp</code> field<a href="#create-timestamp-field" class="hash-link" aria-label="Direct link to create-timestamp-field" title="Direct link to create-timestamp-field">‚Äã</a></h3>
<p>We looked into many details now when we&#x27;ve created that <code>message</code> field. This time we&#x27;re doing something very similar, so we don&#x27;t need to talk about anything new.</p>
<p>Let&#x27;s create a second file, named <code>002-timestamp-field.json</code> with the following content:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[1, 0, &quot;schema_field_definition_v1&quot;, { &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;int&quot; }]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It looks almost the same, just has a different <code>name</code> and <code>type</code>. This time we choose an integer type because we want our timestamp to be a regular <a href="https://en.wikipedia.org/wiki/Unix_time" target="_blank" rel="noopener noreferrer">Unix time number</a>.</p>
<p>We create a new field document by sending this operation as well to the node:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">cat</span><span class="token plain"> 002-timestamp-field.json </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will get a similar output again when everything went fine. Keep a note of the <em>Operation Id</em> for this field, we need it in the next step.</p>
<p>Also, if you are curious, you can run the GraphQL query again and find out that there are two field documents now on your node.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-chat-schema">Create <code>chat</code> schema<a href="#create-chat-schema" class="hash-link" aria-label="Direct link to create-chat-schema" title="Direct link to create-chat-schema">‚Äã</a></h3>
<p>Finally we want to create the actual schema! Here we define the <code>name</code> of the schema, give it a small <code>description</code> and refer to the <code>fields</code> we&#x27;ve created before.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Tedious work?</div><div class="admonitionContent_BuS1"><p>We need to send three operations to create a schema, this is so much work! But remember, we&#x27;re doing it with a very minimal <code>send-to-node</code> tool right now for the purpose of learning how it works <em>under the hood</em> or <em>behind the scenes</em> and so on.</p><p>Later there will be tools like <code>fishyfish</code> to create schemas in one step, they handle all of these requests automatically for you. Or you can write your own tool or scripts of course using the p2panda <a href="/sdks">SDKs</a>.</p></div></div>
<p>We do this again by creating a new document named <code>003-chat-schema.json</code> with the following operation inside:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  1,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  0,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  &quot;schema_definition_v1&quot;,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    &quot;description&quot;: &quot;My first p2panda chat schema&quot;,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    &quot;fields&quot;: [</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      [&quot;&lt;insert your `message` document id here&gt;&quot;],</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      [&quot;&lt;insert your `timestamp` document id here&gt;&quot;]</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    &quot;name&quot;: &quot;chat&quot;</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This looks slightly different from the previous operations we were sending, but a couple of things are the same: We&#x27;re again sending a CREATE operation, but this time using the <code>schema_definition_v1</code> schema id which requires us to fill out the three fields: <code>description</code>, <code>fields</code> and <code>name</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Ordering of the fields</div><div class="admonitionContent_BuS1"><p>You would probably like to start with <code>name</code> as the first field, right? The ordering of the field names <em>needs</em> to be alphabetical though. You can try a different order, but the <code>aquadoggo</code> will reject it with a friendly error message telling you what order it expected the fields to be.</p><p>All of this is required to ensure an <a href="/specifications/aquadoggo/encoding-data">canonical encoding</a> of operations.</p></div></div>
<p>Did you keep track of the document id&#x27;s of your <code>message</code> and <code>timestamp</code> documents somewhere? Insert them in the placeholders in the .json file. If you don&#x27;t have them anymore, you can also check the GraphQL playground using the same query we already tried before. It will give you the <code>documentId</code> of the two fields.</p>
<p>My <code>fields</code> looks like this now, yours should be similar, just with different hashes:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">&quot;fields&quot;: [</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  [&quot;0020f7be169cacc814b21526e018ad3cb423c93b215b5bd4901146b6bed1b1c4560e&quot;],</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  [&quot;002074ffa5d2e9e5c721483cad91cdfd8ebbd3ac1e716831ff5934becc83f5e13329&quot;]</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Pinned relations and schema migrations</div><div class="admonitionContent_BuS1"><p>The <code>fields</code> look funny with their nested array structure, did you notice that? You&#x27;re using a pinned relation here actually, which means that we&#x27;re pointing our <code>chat</code> schema at <em>exactly</em> these versions of our fields.</p><p>Since a document version can consist of multiple, concurrent operations we have a multi-dimensional array here, to give us the option to address more than one operation expressing our <em>view</em>. Concurrent operations can happen if multiple users update the document at the same time! We usually don&#x27;t have to worry much about it though, as all of this is handled by p2panda, but it might be interesting to know for you what is going on here.</p><p>Currently there is only one view id since you&#x27;ve just created the fields, but imagine you will update your fields in the future. That might break something for some users as suddenly the name of the field changed etc. To prevent this, we&#x27;re pinning everything to a historical state, so there are no surprises.</p><p>Of course the users can still follow your update, but then they have to use the new schema id. Isn&#x27;t that cool? We get <strong>schema migrations</strong> for free.</p></div></div>
<p>We send this operation again to our node via:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">cat</span><span class="token plain"> 003-chat-schema.json </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And now it gets exciting! Let&#x27;s open the playground and have a look into the <em>Docs</em> tab on the right hand side. There it is! Our new <code>chat</code> schema!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Huh, I don&#x27;t see anything?</div><div class="admonitionContent_BuS1"><p>Oh, maybe you should refresh the page then (the playground&#x27;s auto-refresh can be turned on / off). If it still doesn&#x27;t work you might have used the wrong hashes? Double check it! I hope you didn&#x27;t use the ones from my example, because your hashes will surely be different!</p></div></div>
<p>We can even query that schema now, you just need to insert your schema id before (you&#x27;ll find it in the <em>Docs</em> tab, or just use the autocomplete feature of the Playground):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  all_&lt;insert your schema id here&gt; {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    documents {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      fields {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        message</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        timestamp</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It will return an empty response. Of course, we haven&#x27;t created a chat message yet, let&#x27;s do it!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Curious polar bear</div><div class="admonitionContent_BuS1"><p>Did you have a peek at the logs of your <code>aquadoggo</code>?</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-a-new-chat-message">Create a new chat message!<a href="#create-a-new-chat-message" class="hash-link" aria-label="Direct link to Create a new chat message!" title="Direct link to Create a new chat message!">‚Äã</a></h2>
<p>We create our first document using the application schema we&#x27;ve just created. For this we need it&#x27;s <em>Schema Id</em>, we should have already checked it in the steps before, if not, please have a look in the Playground, you&#x27;ll find it in the <em>Docs</em> tab on the right hand side.</p>
<p>Use this schema id to write your first CREATE operation, again we need a new file <code>004-create-message.json</code> for this with the following content:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  1,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  0,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  &quot;&lt;insert your schema id here&gt;&quot;,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    &quot;message&quot;: &quot;Hello, Panda!&quot;,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    &quot;timestamp&quot;: 1662459998</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Just replace the schema id with your own and send the operation via:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">cat</span><span class="token plain"> 004-create-message.json </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Woho! Have a look in the GraphQL playground, you can query your chat message there now.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update-chat-message">Update chat message<a href="#update-chat-message" class="hash-link" aria-label="Direct link to Update chat message" title="Direct link to Update chat message">‚Äã</a></h2>
<p>We are building a special chat program where we can also edit our messages afterwards. Let&#x27;s send an UPDATE operation to change the chat message document we&#x27;ve created in the step before.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Show changes</div><div class="admonitionContent_BuS1"><p>If we want to build a <em>really cool</em> chat application we could even show the history of edits with pinned relations.</p></div></div>
<p>For this we&#x27;re creating another file named <code>005-update-message.json</code> with the following content:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  1,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  1,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  &quot;&lt;insert your schema id here&gt;&quot;,</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  [&quot;&lt;insert your view id here&gt;&quot;],</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    &quot;message&quot;: &quot;Good night, Panda!&quot;</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This looks again a little bit different now. UPDATE operations have the <code>action</code> field set to <code>1</code> as you can see and require us to specify a <code>previous</code> field. It indicates where we are planning to apply the update.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêß</span></span>Operation graphs</div><div class="admonitionContent_BuS1"><p>The <code>previous</code> field is really powerful. Imagine many users applying updates to a document at the same time, with the <code>previous</code> field we are able to understand what all of these users meant when they wanted to apply their changes. Not every user might have seen the same as the others, for example one user might have been offline and worked on a slightly <em>outdated</em> version of the document, another one was writing right after another user and did not take that change into account yet and so on.</p><p>With the help of the <code>previous</code> field we can build a whole <em>Operation Graph</em> of all changes which have been applied to a document and try to reconstruct one document version of it, even though the changes might have been made concurrently.</p></div></div>
<p>Another thing to note here is that we do not have to mention <em>all</em> fields of our <code>chat</code> schema, but only the ones we want to update, in this case it is the <code>message</code> field.</p>
<p>We&#x27;re already having the schema id and we can insert it into <code>005-update-message.json</code> but where do we get that <em>view id</em> from? It is basically the last known version of that document we want to apply the changes on, we also call this a <a href="/specifications/aquadoggo/data-types/document-views"><em>Document View Id</em></a>.</p>
<p>Again, the GraphQL playground can help us here. We can simply just query all chat messages and ask for their regarding <code>viewId</code> with the following query:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  all_&lt;insert your schema id here&gt; {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    documents {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      meta {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        documentId</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        viewId</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      fields {</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        message</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">        timestamp</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d3d0c8"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You might notice that the <code>viewId</code> is actually currently the same as the <code>documentId</code>, this is because there is <em>only</em> one version of this document right now. As soon as we apply some updates you will notice that the <code>documentId</code> will stay the same, but the <code>viewId</code> will evolve to something else.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Latest document vs. document view</div><div class="admonitionContent_BuS1"><p>This is exactly the difference between a <em>document id</em> and a <em>view id</em>: The document id will always give you the <em>latest known</em> version of a document, the data might change over time as soon as there are more updates coming. The <em>view id</em> will give you a particular version which will never change ever. It is <em>immutable</em>.</p><p>What is the <em>latest</em> is up to the node, it might <em>think</em> it knows the latest version, but actually it has not synced up yet with other nodes to really see the latest changes. But that&#x27;s just how it is in a p2p network. Thanks to p2panda operations and <a href="https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type" target="_blank" rel="noopener noreferrer">CRDTs</a> we don&#x27;t need to worry about it too much.</p></div></div>
<p>We have all informations now to finally send this update:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">cat</span><span class="token plain"> 005-update-message.json </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Go back to the playground and re-play your query, you should see the latest version now and maybe even see that the <code>viewId</code> changed!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="delete-chat-message">Delete chat message<a href="#delete-chat-message" class="hash-link" aria-label="Direct link to Delete chat message" title="Direct link to Delete chat message">‚Äã</a></h2>
<p>Last but not least we want to delete our chat message, just to also learn how to use DELETE operations.</p>
<p>This is our last JSON file named <code>006-delete-message.json</code>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token plain">[1, 2, &quot;&lt;insert your schema id here&gt;&quot;, [&quot;&lt;insert your last view id here&gt;&quot;]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Woah, no <em>fields</em>? Yes, we do not need them when we delete a document. Also you may have noticed that the <em>action</em> field is now set to <code>2</code> to indicate that this is a DELETE operation.</p>
<p>Similar to UPDATE operations we also need to set the <code>previous</code> field again. We need to tell the <code>aquadoggo</code> where we&#x27;re applying that deletion. Again, we can get that information from the GraphQL playground, run the query again and retrieve the <code>viewId</code> from there, it is the <em>latest known state</em> from our node&#x27;s perspective.</p>
<p>After running the <code>send-to-node</code> program via ..</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d3d0c8;--prism-background-color:#2d2d2d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d3d0c8;background-color:#2d2d2d"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d3d0c8"><span class="token function" style="color:#66cccc;font-weight:bold">cat</span><span class="token plain"> 006-delete-message.json </span><span class="token operator" style="color:#f2f0ec">|</span><span class="token plain"> </span><span class="token function" style="color:#66cccc;font-weight:bold">cargo</span><span class="token plain"> run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>.. we should now get an empty response again in the GraphQL playground. There are no chat messages anymore!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">üêª‚Äç‚ùÑÔ∏è</span></span>Comparison with databases</div><div class="admonitionContent_BuS1"><p>Think about it from the perspective of a &quot;traditional&quot; database. You probably need to specify the ID of the row or item you want to delete in the database.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="done">Done!<a href="#done" class="hash-link" aria-label="Direct link to Done!" title="Direct link to Done!">‚Äã</a></h2>
<p>Yay! Now you know how to create a schema and even documents with the <code>send-to-node</code> tool. You could also write your own program which sends and signs the operations using the p2panda <a href="/sdks">SDKs</a>. Querying documents and publishing operations via GraphQL is basically everything a p2panda client is doing. In this tutorial we did it <em>manually</em> but a client of course would do it all for us in the background.</p>
<p>Check out the <a href="/tutorials/mushroom-app">next tutorial</a> on how to build a client in React if you&#x27;re curious about how to actually do this.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-do-i-need" class="table-of-contents__link toc-highlight">What do I need?</a></li><li><a href="#what-is-send-to-node" class="table-of-contents__link toc-highlight">What is <code>send-to-node</code>?</a><ul><li><a href="#how-does-it-work" class="table-of-contents__link toc-highlight">How does it work?</a></li><li><a href="#install-send-to-node" class="table-of-contents__link toc-highlight">Install <code>send-to-node</code></a></li></ul></li><li><a href="#start-node" class="table-of-contents__link toc-highlight">Start node</a></li><li><a href="#create-a-schema" class="table-of-contents__link toc-highlight">Create a schema</a><ul><li><a href="#create-message-field" class="table-of-contents__link toc-highlight">Create <code>message</code> field</a></li><li><a href="#create-timestamp-field" class="table-of-contents__link toc-highlight">Create <code>timestamp</code> field</a></li><li><a href="#create-chat-schema" class="table-of-contents__link toc-highlight">Create <code>chat</code> schema</a></li></ul></li><li><a href="#create-a-new-chat-message" class="table-of-contents__link toc-highlight">Create a new chat message!</a></li><li><a href="#update-chat-message" class="table-of-contents__link toc-highlight">Update chat message</a></li><li><a href="#delete-chat-message" class="table-of-contents__link toc-highlight">Delete chat message</a></li><li><a href="#done" class="table-of-contents__link toc-highlight">Done!</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_J6tW"><img class="footer-img__0Xc" src="/images/deepsea-panda.svg" width="100"><div><img class="supporters-img_P2oV" src="/images/nlnet-logo.svg" width="140"><img class="supporters-img_P2oV" src="/images/ngi-logo.png" width="200"><img class="supporters-img_P2oV" src="/images/eu-flag-logo.png" width="78"><p class="footer-text_MXRq">This project has received funding from the European Union‚Äôs Horizon 2020 research and innovation programme within the framework of the NGI-POINTER Project funded under grant agreement No 871528, NGI-ASSURE No 957073 and NGI0-ENTRUST No 101069594</p></div><p class="footer-text_MXRq">CC BY-SA 4.0<!-- --> - <a href="/contact">Contact</a> -<!-- --> <a href="https://autonomous.zone/@p2panda" target="_blank" rel="noreferrer">Fediverse</a></p></footer></div>
</body>
</html>