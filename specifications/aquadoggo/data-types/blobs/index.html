<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-specifications/aquadoggo/data-types/blobs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Blobs | p2panda</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://p2panda.org/specifications/aquadoggo/data-types/blobs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Blobs | p2panda"><meta data-rh="true" name="description" content="The blob specification describes system schemas and validation conditions used when publishing binary application data. Blobs require their own materialization logic and these system schemas allow a node to distinguish blob documents from other application data and behave accordingly. Conceptually, blobs can be considered to be &quot;attachments&quot; on other documents. It is not intended that blobs alone serve as a general purpose content delivery system. We expect blobs to be attached to other documents via relation fields, replication and materialization logic can be optimized based on this assumption. See the blob http specification to read how blobs are materialized and served on a node."><meta data-rh="true" property="og:description" content="The blob specification describes system schemas and validation conditions used when publishing binary application data. Blobs require their own materialization logic and these system schemas allow a node to distinguish blob documents from other application data and behave accordingly. Conceptually, blobs can be considered to be &quot;attachments&quot; on other documents. It is not intended that blobs alone serve as a general purpose content delivery system. We expect blobs to be attached to other documents via relation fields, replication and materialization logic can be optimized based on this assumption. See the blob http specification to read how blobs are materialized and served on a node."><link data-rh="true" rel="icon" href="/images/deepsea-panda.svg"><link data-rh="true" rel="canonical" href="https://p2panda.org/specifications/aquadoggo/data-types/blobs"><link data-rh="true" rel="alternate" href="https://p2panda.org/specifications/aquadoggo/data-types/blobs" hreflang="en"><link data-rh="true" rel="alternate" href="https://p2panda.org/specifications/aquadoggo/data-types/blobs" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="p2panda News RSS Feed"><link rel="stylesheet" href="/assets/css/styles.862b1275.css">
<script src="/assets/js/runtime~main.c81b6c81.js" defer="defer"></script>
<script src="/assets/js/main.97848bd4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><div class="navbar__brand"><div class="navbar__logo"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></div></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/learn/">Learn</a><a class="navbar__item navbar__link" href="/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/sdks/">SDKs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/specifications/">Specifications</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/links">Links</a><a class="navbar__item navbar__link" href="/contact">Contact</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/p2panda-book.png" alt="p2panda Handbook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specifications/">Specifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specifications/namakemono/">namakemono</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/specifications/aquadoggo/">aquadoggo API</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/key-concepts">Key Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/specifications/aquadoggo/data-types/bamboo">Core data types</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/data-types/bamboo">Bamboo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/data-types/key-pairs">Key Pairs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/data-types/operations">Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/data-types/schemas">Schemas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/data-types/documents">Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/data-types/document-views">Document views</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/specifications/aquadoggo/data-types/blobs">Blobs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/specifications/aquadoggo/APIs/overview">APIs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/specifications/aquadoggo/networking/clients-nodes">Networking</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/replication">Replication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/encoding-data">Canonical Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/specifications/aquadoggo/glossary">Glossary</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><img src="/images/deepsea-panda.svg" width="30" class="icon-home_wWeS"></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">aquadoggo API</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core data types</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Blobs</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Blobs</h1></header><p>The blob specification describes system <a href="/specifications/aquadoggo/data-types/schemas">schemas</a> and validation conditions used when publishing binary application data. Blobs require their own materialization logic and these system <a href="/specifications/aquadoggo/data-types/schemas">schemas</a> allow a node to distinguish blob <a href="/specifications/aquadoggo/data-types/documents">documents</a> from other application data and behave accordingly. Conceptually, blobs can be considered to be &quot;attachments&quot; on other <a href="/specifications/aquadoggo/data-types/documents">documents</a>. It is not intended that blobs alone serve as a general purpose content delivery system. We expect blobs to be attached to other <a href="/specifications/aquadoggo/data-types/documents">documents</a> via relation fields, replication and materialization logic can be optimized based on this assumption. See the <a href="/specifications/aquadoggo/APIs/blob-http">blob http specification</a> to read how blobs are materialized and served on a node.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="system-schemas">System schemas<a href="#system-schemas" class="hash-link" aria-label="Direct link to System schemas" title="Direct link to System schemas">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="blob">Blob<a href="#blob" class="hash-link" aria-label="Direct link to Blob" title="Direct link to Blob">​</a></h3>
<ul>
<li>Schema id: <code>blob_v1</code></li>
<li>Representing a binary file</li>
<li>Fields:<!-- -->
<ul>
<li><code>length</code>: length of file in bytes (u64)</li>
<li><code>mime_type</code> IANA mime-type (string)</li>
<li><code>pieces</code>: list of pieces which make up this blob (pinned relation list of <code>blob_piece_v1</code>)</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">🐻‍❄️</span></span>Why no file name or path?</div><div class="admonitionContent_BuS1"><p>We designed blobs to be as generic as possible, giving developers the option to come up with their own application schemas on top of them. Information like a file name or path is <em>optional</em> meta data. If you need it, you can for example create a schema which contains a <code>file_name</code>, <code>path</code> field and a relation to a <code>blob_v1</code> document. This can be interesting for building an application which materializes files into a specific folder structure, similar to BitTorrent.</p></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">🌩️</span></span>Requirements</div><div class="admonitionContent_BuS1"><ul>
<li>The claimed <code>length</code> of a <code>blob_v1</code> document should be validated on publishing<!-- -->
<ul>
<li>This can be done by collecting all claimed pieces and calculating total length</li>
<li>OR only validating that each <code>blob_piece_v1</code> is the correct length and then validating the <code>length</code> value by checking the number of items in the <code>pieces</code> list</li>
</ul>
</li>
<li>The claimed <code>mime_type</code> should be validated</li>
<li>Validating blob pieces differs if they arrive through the Client API or Replication API<!-- -->
<ul>
<li>Client API: all blob pieces should already exist before publishing the <code>blob</code></li>
<li>Replication API: a <code>blob</code> must exist with a relation to the <code>pieces</code> before the pieces are accepted. This means we don&#x27;t accept arbitrary blob data until we know the blob hash id, as we may want to choose to lazy load a blob&#x27;s actual data.</li>
</ul>
</li>
<li>The <code>pieces</code> field can not be empty</li>
<li>If a validation step fails, an error should be returned to the client and <em>all</em> related <code>blob_piece_v1</code> and the <code>blob_v1</code> entries should be deleted</li>
</ul></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="blob-piece">Blob Piece<a href="#blob-piece" class="hash-link" aria-label="Direct link to Blob Piece" title="Direct link to Blob Piece">​</a></h3>
<ul>
<li>Schema id: <code>blob_piece_v1</code></li>
<li>Representing the (partial) binary data of a file</li>
<li>Fields:<!-- -->
<ul>
<li><code>data</code>: bytes contained in this blob piece (bytes)</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><span class="panda-icon">🌩️</span></span>Requirements</div><div class="admonitionContent_BuS1"><ul>
<li>All blob pieces must be of maximum 256KB size</li>
</ul></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notes-on-storage">Notes on Storage<a href="#notes-on-storage" class="hash-link" aria-label="Direct link to Notes on Storage" title="Direct link to Notes on Storage">​</a></h2>
<ul>
<li><code>blob_v1</code> and <code>blob_piece_v1</code> data is persisted on a node</li>
<li>The materialization logic differs from other documents, see the <a href="/specifications/aquadoggo/APIs/blob-http">blob http specification</a> to read more</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notes-on-replication">Notes on Replication<a href="#notes-on-replication" class="hash-link" aria-label="Direct link to Notes on Replication" title="Direct link to Notes on Replication">​</a></h2>
<ul>
<li>Nodes can choose to ignore blobs when they exceed certain minimum or maximum length requirements or have unsupported mime types</li>
<li>Nodes can choose to only replicate blob pieces when there is at least one relation to the blob itself from other documents</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/specifications/aquadoggo/data-types/document-views"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Document views</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/specifications/aquadoggo/APIs/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#system-schemas" class="table-of-contents__link toc-highlight">System schemas</a><ul><li><a href="#blob" class="table-of-contents__link toc-highlight">Blob</a></li><li><a href="#blob-piece" class="table-of-contents__link toc-highlight">Blob Piece</a></li></ul></li><li><a href="#notes-on-storage" class="table-of-contents__link toc-highlight">Notes on Storage</a></li><li><a href="#notes-on-replication" class="table-of-contents__link toc-highlight">Notes on Replication</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_J6tW"><img class="footer-img__0Xc" src="/images/deepsea-panda.svg" width="100"><div><img class="supporters-img_P2oV" src="/images/nlnet-logo.svg" width="140"><img class="supporters-img_P2oV" src="/images/ngi-logo.png" width="200"><img class="supporters-img_P2oV" src="/images/eu-flag-logo.png" width="78"><p class="footer-text_MXRq">This project has received funding from the European Union’s Horizon 2020 research and innovation programme within the framework of the NGI-POINTER Project funded under grant agreement No 871528, NGI-ASSURE No 957073 and NGI0-ENTRUST No 101069594</p></div><p class="footer-text_MXRq">CC BY-SA 4.0<!-- --> - <a href="/contact">Contact</a> -<!-- --> <a href="https://autonomous.zone/@p2panda" target="_blank" rel="noreferrer">Fediverse</a></p></footer></div>
</body>
</html>